(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-array"),require("d3-scale"),require("d3-time"),require("d3-random"),require("d3-fetch"),require("d3-path"),require("d3-selection"),require("d3-shape"),require("d3-dispatch"),require("d3-brush")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-scale","d3-time","d3-random","d3-fetch","d3-path","d3-selection","d3-shape","d3-dispatch","d3-brush"],t):(e=e||self,t(e.fc={},e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3))})(this,function(e,t,a,n,i,r,l,o,s,c,h){'use strict';var z=Math.round,O=Math.floor,H=Math.min,G=Math.ceil,U=Math.exp,M=Math.max,F=Math.abs;function g(e){return e}function u(){}function f(e){return"function"==typeof e?e:()=>e}function p(e){return"number"==typeof e&&isNaN(e)?void 0:e}function m(){let e=()=>10,t=u,a=g,n=e=>null!=e;var i=function(i){const r=e.apply(this,arguments),l=i.slice(0,r).map(a);return i.map((e,d)=>(d>=r&&(l.shift(),l.push(a(e,d))),d<r-1||l.some(e=>!n(e))?t(void 0,d):t(l,d)))};return i.period=(...t)=>t.length?(e=f(t[0]),i):e,i.accumulator=(...e)=>e.length?(t=e[0],i):t,i.defined=(...e)=>e.length?(n=e[0],i):n,i.value=(...e)=>e.length?(a=e[0],i):a,i}function y(){let e=2;const a=m().accumulator(a=>{const n=a&&t.deviation(a),i=a&&t.mean(a);return{average:i,upper:p(i+e*n),lower:p(i-e*n)}}),n=e=>a(e);return n.multiplier=(...t)=>t.length?(e=t[0],n):e,q(n,a,"period","value"),n}function x(){let e=g,a=()=>9;const n=e=>{let a=[];return n=>{let i;return a.length<e&&(null==n?a=[]:a.push(n)),a.length>=e&&(i=t.mean(a)),i}},i=function(t){const i=a.apply(this,arguments),r=2/(i+1),l=n(i);let o;return t.map((t,a)=>{const n=e(t,a);return o=void 0===o?l(n):n*r+(1-r)*o,p(o)})};return i.period=(...e)=>e.length?(a=f(e[0]),i):a,i.value=(...t)=>t.length?(e=t[0],i):e,i}function b(){let e=g;const a=x().period(12),n=x().period(26),i=x().period(9),r=r=>{a.value(e),n.value(e);const l=t.zip(a(r),n(r)).map(e=>void 0!==e[0]&&void 0!==e[1]?e[0]-e[1]:void 0),d=i(l);return t.zip(l,d).map(e=>({macd:e[0],signal:e[1],divergence:void 0!==e[0]&&void 0!==e[1]?e[0]-e[1]:void 0}))};return r.value=(...t)=>t.length?(e=t[0],r):e,X(r,a,$({period:"fastPeriod"})),X(r,n,$({period:"slowPeriod"})),X(r,i,$({period:"signalPeriod"})),r}function v(){const e=m().accumulator(e=>e&&t.mean(e)),a=t=>e(t);return q(a,e,"period","value"),a}function S(){let e=.1,t=g;const a=a=>a.map(a=>{const n=p(t(a)*(1-e)),i=p(t(a)*(1+e));return{lower:n,upper:i}});return a.factor=(...t)=>t.length?(e=t[0],a):e,a.value=(...e)=>e.length?(t=e[0],a):t,a}function w(){let e=e=>e.close,a=e=>e.high,n=e=>e.low;const i=x().period(13),r=r=>(i.value(e),t.zip(r,i(r)).map(e=>{const t=p(a(e[0])-e[1]),i=p(n(e[0])-e[1]);return{bullPower:t,bearPower:i}}));return r.closeValue=(...t)=>t.length?(e=t[0],r):e,r.highValue=(...e)=>e.length?(a=e[0],r):a,r.lowValue=(...e)=>e.length?(n=e[0],r):n,q(r,i,"period"),r}function V(){var e={};return e.distance=function(e,t){return t-e},e.offset=function(e,t){return e instanceof Date?new Date(e.getTime()+t):e+t},e.clampUp=e=>e,e.clampDown=e=>e,e.copy=()=>e,e}function k(e,t){const a=[];for(const n of e){const e=t.clampUp(n),i=t.clampDown(n);e===i&&a.push(e)}return a}function E(e){arguments.length||(e=a.scaleIdentity());var t=V();const n=a=>{var n=e.domain(),i=e.range(),r=t.distance(n[0],n[1]),l=t.distance(n[0],a),d=l/r*(i[1]-i[0])+i[0];return d};return n.invert=a=>{var n=e.domain(),i=e.range(),r=(a-i[0])/(i[1]-i[0]),l=t.distance(n[0],n[1]);return t.offset(n[0],r*l)},n.domain=(...a)=>{if(!a.length)return e.domain();const i=a[0];var r=t.clampUp(i[0]),l=t.clampDown(i[1]);return e.domain([r,l]),n},n.nice=()=>{e.nice();var a=e.domain(),i=t.clampUp(a[0]),r=t.clampDown(a[1]);return e.domain([i,r]),n},n.ticks=(...a)=>{var n=e.ticks.apply(this,a);return k(n,t)},n.copy=()=>E(e.copy()).discontinuityProvider(t.copy()),n.discontinuityProvider=(...e)=>e.length?(t=e[0],n):t,X(n,e,Z("range","rangeRound","interpolate","clamp","tickFormat")),n}function A(){let e=[e=>e],a=[0,0],n="percent",i=null,r=[];const l=l=>{const d=Array(l.length);for(const t of e)for(let e=0;e<l.length;e++){const a=t(l[e],e);Array.isArray(a)?d.push(...a):d.push(a)}const o=[t.min(d),t.max(d)];if(o[0]=null==o[0]?t.min(r):t.min([o[0],...r]),o[1]=null==o[1]?t.max(r):t.max([o[1],...r]),null!=i){const e=M(F(o[1]-i),F(o[0]-i));o[0]=i-e,o[1]=i+e}switch(n){case"domain":{o[0]-=a[0],o[1]+=a[1];break}case"percent":{const e=o[1]-o[0];o[0]-=a[0]*e,o[1]+=a[1]*e;break}default:throw new Error(`Unknown padUnit: ${n}`);}return o};return l.accessors=(...t)=>t.length?(e=t[0],l):e,l.pad=(...e)=>e.length?(a=e[0],l):a,l.padUnit=(...e)=>e.length?(n=e[0],l):n,l.include=(...e)=>e.length?(r=e[0],l):r,l.symmetricalAbout=(...e)=>e.length?(i=e[0],l):i,l}function T(){let e=[],t=[0,0],a="percent",n=null,i=[];const r=A(),l=e=>null==e?null:e.valueOf(),d=d=>{const o=e.map(e=>(...t)=>{const a=e(...t);return Array.isArray(a)?a.map(l):l(a)});return r.accessors(o).pad(t).padUnit(a).symmetricalAbout(null==n?null:n.valueOf()).include(i.map(e=>e.valueOf())),r(d).map(e=>new Date(e))};return d.accessors=(...t)=>t.length?(e=t[0],d):e,d.pad=(...e)=>e.length?(t=e[0],d):t,d.padUnit=(...e)=>e.length?(a=e[0],d):a,d.include=(...e)=>e.length?(i=e[0],d):i,d.symmetricalAbout=(...e)=>e.length?(n=e[0],d):n,d}function I(){let e=1,t=20,a=.1,n=.1,r=i.randomNormal();var l=(i=0)=>{var l=Math.sqrt;const d=e/t,o=[];for(let e=0;e<t+1;e++){o.push(i);const e=r()*l(d)*n+(a-n*n/2)*d;i*=U(e)}return o};return l.period=(...t)=>t.length?(e=t[0],l):e,l.steps=(...e)=>e.length?(t=e[0],l):t,l.mu=(...e)=>e.length?(a=e[0],l):a,l.sigma=(...e)=>e.length?(n=e[0],l):n,l.random=(...e)=>e.length?(r=e[0],l):r,l}function _(e){return"function"==typeof e?e:()=>e}function B(){let e=new Date,t=100,a=n.timeDay,r=1,l=n.timeYear,d=1,o=null,s=()=>{const e=i.randomNormal(1,.1);return G(1e3*e())};const c=I(),h=e=>{const t=l.offset(e,d)-e;return(a.offset(e,r)-e)/t},g=(e,t)=>{const a=h(e),n=c.period(a)(t),i={date:e,open:n[0],high:M.apply(Math,n),low:H.apply(Math,n),close:n[c.steps()]};return i.volume=s(i),i},u=n=>{let i,l,d;do i=n?a.offset(n.date,r):new Date(e.getTime()),l=n?n.close:t,n=g(i,l),d=o&&!o(n);while(d);return n},f=()=>{let e;const t={};return t.next=()=>{const t=u(e);return e=t,t},t.take=e=>t.until((t,a)=>!e||0>e||a===e),t.until=t=>{const a=[];let n=0,i=u(e),r=t&&!t(i,n);for(;r;)a.push(i),e=i,i=u(e),n+=1,r=t&&!t(i,n);return a},t},p=e=>f().take(e);if(p.stream=f,"function"!=typeof Symbol||"symbol"!=typeof Symbol.iterator)throw new Error("d3fc-random-data depends on Symbol. Make sure that you load a polyfill in older browsers. See README.");return p[Symbol.iterator]=()=>{const e=f();return{next:()=>({value:e.next(),done:!1})}},p.startDate=(...t)=>t.length?(e=t[0],p):e,p.startPrice=(...e)=>e.length?(t=e[0],p):t,p.interval=(...e)=>e.length?(a=e[0],p):a,p.intervalStep=(...e)=>e.length?(r=e[0],p):r,p.unitInterval=(...e)=>e.length?(l=e[0],p):l,p.unitIntervalStep=(...e)=>e.length?(d=e[0],p):d,p.filter=(...e)=>e.length?(o=e[0],p):o,p.volume=(...e)=>e.length?(s=_(e[0]),p):s,X(p,c),p}function P(){var e="BTC-USD",t=null,a=null,n=null,i=function(){var i=[];null!=t&&i.push("start="+t.toISOString()),null!=a&&i.push("end="+a.toISOString()),null!=n&&i.push("granularity="+n);var l="https://api.gdax.com/products/"+e+"/candles?"+i.join("&");return r.json(l).then(function(e){return e.map(function(e){return{date:new Date(1e3*e[0]),open:e[3],high:e[2],low:e[1],close:e[4],volume:e[5]}})})};return i.product=function(t){return arguments.length?(e=t,i):e},i.start=function(e){return arguments.length?(t=e,i):t},i.end=function(e){return arguments.length?(a=e,i):a},i.granularity=function(e){return arguments.length?(n=e,i):n},i}function C(){var e=10,a=a=>1>=e?a.map(e=>[e]):t.range(0,G(a.length/e)).map(t=>a.slice(t*e,(t+1)*e));return a.bucketSize=function(t){return arguments.length?(e=t,a):e},a}function N(){function e(e){var a=e.map(e=>[n(e),i(e)]),r=t.range(1,a.length-1).map(e=>{var t=a[e-1],n=a[e],i=a[e+1];return .5*F((t[0]-i[0])*(n[1]-t[1])-(t[0]-n[0])*(i[1]-t[1]))});return r}var a=C(),n=e=>e,i=e=>e;const r=n=>{if(a.bucketSize()>=n.length)return n;var i=e(n),r=a(i),l=a(n.slice(1,n.length-1)),d=l.map((e,a)=>{var n=r[a],i=t.max(n),l=n.indexOf(i);return e[l]});return[].concat([n[0]],d,[n[n.length-1]])};return q(r,a,"bucketSize"),r.x=function(e){return arguments.length?(n=e,r):n},r.y=function(e){return arguments.length?(i=e,r):i},r}function R(){var e=e=>e,a=e=>e,n=C();const i=i=>{if(n.bucketSize()>=i.length)return i;var r=n(i.slice(1,i.length-1)),l=i[0],d=i[i.length-1],o=[].concat([l],r,[d]),s=e(l),c=a(l),h=r.map((n,r)=>{var i=t.mean(o[r+1],e),l=t.mean(o[r+1],a),d=n.map(t=>[e(t),a(t)]),h=d.map(e=>.5*F((s-i)*(e[1]-c)-(s-e[0])*(l-c))),g=h.indexOf(t.max(h)),u=d[g];return s=u[0],c=u[1],n[g]});return[].concat([i[0]],h,[i[i.length-1]])};return q(i,n,"bucketSize"),i.x=function(t){return arguments.length?(e=t,i):e},i.y=function(e){return arguments.length?(a=e,i):a},i}function D(){var e=C(),a=e=>e;const n=n=>{if(e.bucketSize()>n.length)return n;var i=t.extent(n,a),r=e(n.slice(1,n.length-1)),l=r.map(e=>{var t,n,r={},l=!0,d=e.map(a),o=d.filter(e=>e===i[0]||e===i[1]).map(e=>d.indexOf(e))[0];return void 0===o?(d.forEach((e,a)=>{void 0===r[e]&&(r[e]=0),r[e]++,r[e]>r[t]||void 0===t?(t=e,n=a,l=!0):r[e]===r[t]&&(l=!1)}),l?e[n]:e[O(e.length/2)]):e[o]});return[].concat([n[0]],l,[n[n.length-1]])};return q(n,e,"bucketSize"),n.value=function(e){return arguments.length?(a=e,n):a},n}function L(){const e=arguments;return function(t,a){for(let n=0,i=e.length;n<i;n++)if(null==e[n](t,a))return!1;return!0}}var W="default"in a?a["default"]:a,Y="default"in s?s["default"]:s,Q=(e,t,a)=>{const n=t[a];if("function"!=typeof n)throw new Error(`Attempt to rebind ${a} which isn't a function on the source object`);return(...a)=>{var i=n.apply(t,a);return i===t?e:i}},q=(e,t,...a)=>{for(const n of a)e[n]=Q(e,t,n);return e};const j=e=>t=>e.reduce((e,t)=>e&&t(e),t);var X=(e,t,...a)=>{const n=j(a);for(const i of Object.keys(t)){const a=n(i);a&&(e[a]=Q(e,t,i))}return e},K=e=>e.map(e=>"string"==typeof e?new RegExp(`^${e}$`):e),J=(...e)=>(e=K(e),t=>e.every(e=>!e.test(t))&&t),Z=(...e)=>(e=K(e),t=>e.some(e=>e.test(t))&&t),$=e=>t=>e[t];const ee=e=>e[0].toUpperCase()+e.slice(1);var te=e=>t=>e+ee(t);const ae=(e,t,a,n)=>{const i={sunday:0,monday:1,saturday:6},r=86400000,l=5*r,d={},o=t=>0===e(t)||6===e(t);return d.clampDown=a=>{if(a&&o(a)){const n=t.ceil(a);return e(n)===i.sunday?t.offset(n,-1):e(n)===i.monday?t.offset(n,-2):n}return a},d.clampUp=a=>{if(a&&o(a)){const n=t.floor(a);return e(n)===i.saturday?t.offset(n,2):e(n)===i.sunday?t.offset(n,1):n}return a},d.distance=function(e,t){e=d.clampUp(e),t=d.clampDown(t);const n=a.ceil(e);if(t<n)return t.getTime()-e.getTime();const i=n.getTime()-e.getTime(),o=a.ceil(t),s=o.getTime()-t.getTime(),c=z((o.getTime()-n.getTime())/(7*r));return c*l+i-s},d.offset=function(e,i){let r=o(e)?d.clampUp(e):e;if(0===i)return r;const s=0>i;let c=i;const h=s?n.floor(r):a.ceil(r);if(c-=h.getTime()-r.getTime(),s&&0<c||0<i&&0>c)return new Date(r.getTime()+i);r=s?h:t.offset(h,2);const g=O(c/l);return r=t.offset(r,7*g),c-=g*l,r=new Date(r.getTime()+c),r},d.copy=function(){return d},d};var ne=e=>"function"==typeof e?e:()=>e,ie=()=>{let e=null,t=e=>e.date,a=e=>e.open,n=e=>e.high,r=e=>e.low,o=e=>e.close,s="vertical",c=ne(3);const h=function(i){const h=e||l.path();return i.forEach(function(e,l){const i=t(e,l),d=a(e,l),g=n(e,l),u=r(e,l),f=o(e,l),p=c(e,l)/2;"vertical"===s?(h.moveTo(i,u),h.lineTo(i,g),h.moveTo(i,d),h.lineTo(i-p,d),h.moveTo(i,f),h.lineTo(i+p,f)):(h.moveTo(u,i),h.lineTo(g,i),h.moveTo(d,i),h.lineTo(d,i+p),h.moveTo(f,i),h.lineTo(f,i-p))}),e?null:h.toString()};return h.context=(...t)=>t.length?(e=t[0],h):e,h.x=(...e)=>e.length?(t=ne(e[0]),h):t,h.open=(...e)=>e.length?(a=ne(e[0]),h):a,h.high=(...e)=>e.length?(n=ne(e[0]),h):n,h.low=(...e)=>e.length?(r=ne(e[0]),h):r,h.close=(...e)=>e.length?(o=ne(e[0]),h):o,h.width=(...e)=>e.length?(c=ne(e[0]),h):c,h.orient=(...e)=>e.length?(s=e[0],h):s,h},re=()=>{let e=null,t=e=>e.x,a=e=>e.y,n="center",i="center",r=e=>e.height,o=ne(3);const s=function(d,s){const c=e||l.path();return d.forEach(function(e,l){const d=t.call(this,e,s||l),h=a.call(this,e,s||l),g=r.call(this,e,s||l),u=o.call(this,e,s||l);let f;switch(n){case"left":f=u;break;case"right":f=0;break;case"center":f=u/2;break;default:throw new Error("Invalid horizontal alignment "+n);}let p;switch(i){case"bottom":p=-g;break;case"top":p=0;break;case"center":p=g/2;break;default:throw new Error("Invalid vertical alignment "+i);}c.rect(d-f,h-p,u,g)},this),e?null:c.toString()};return s.context=(...t)=>t.length?(e=t[0],s):e,s.x=(...e)=>e.length?(t=ne(e[0]),s):t,s.y=(...e)=>e.length?(a=ne(e[0]),s):a,s.width=(...e)=>e.length?(o=ne(e[0]),s):o,s.horizontalAlign=(...e)=>e.length?(n=e[0],s):n,s.height=(...e)=>e.length?(r=ne(e[0]),s):r,s.verticalAlign=(...e)=>e.length?(i=e[0],s):i,s},le=()=>{let e=null,t=e=>e.date,a=e=>e.open,n=e=>e.high,r=e=>e.low,o=e=>e.close,s=ne(3);const c=function(i){const c=e||l.path();return i.forEach(function(e,l){const i=t(e,l),d=a(e,l),h=n(e,l),g=r(e,l),u=o(e,l),f=s(e,l);c.rect(i-f/2,d,f,u-d),c.moveTo(i,H(u,d)),c.lineTo(i,h),c.moveTo(i,M(u,d)),c.lineTo(i,g)}),e?null:c.toString()};return c.context=(...t)=>t.length?(e=t[0],c):e,c.x=(...e)=>e.length?(t=ne(e[0]),c):t,c.open=(...e)=>e.length?(a=ne(e[0]),c):a,c.high=(...e)=>e.length?(n=ne(e[0]),c):n,c.low=(...e)=>e.length?(r=ne(e[0]),c):r,c.close=(...e)=>e.length?(o=ne(e[0]),c):o,c.width=(...e)=>e.length?(s=ne(e[0]),c):s,c},de=()=>{let e=null,t=e=>e.value,a=e=>e.median,n=e=>e.upperQuartile,r=e=>e.lowerQuartile,o=e=>e.high,s=e=>e.low,c="vertical",h=ne(5),g=ne(.5);const u=function(i){const u=e||l.path();return i.forEach(function(e,l){const i=t(e,l),d=h(e,l),f=d/2,p=d*g(e,l),m=p/2,y=o(e,l),x=n(e,l),b=a(e,l),v=r(e,l),S=s(e,l),w=v-x;"vertical"===c?(u.moveTo(i-m,y),u.lineTo(i+m,y),u.moveTo(i,y),u.lineTo(i,x),u.rect(i-f,x,d,w),u.moveTo(i-f,b),u.lineTo(i+f,b),u.moveTo(i,v),u.lineTo(i,S),u.moveTo(i-m,S),u.lineTo(i+m,S)):(u.moveTo(S,i-m),u.lineTo(S,i+m),u.moveTo(S,i),u.lineTo(v,i),u.rect(v,i-f,-w,d),u.moveTo(b,i-f),u.lineTo(b,i+f),u.moveTo(x,i),u.lineTo(y,i),u.moveTo(y,i-m),u.lineTo(y,i+m))}),e?null:u.toString()};return u.context=(...t)=>t.length?(e=t[0],u):e,u.value=(...e)=>e.length?(t=ne(e[0]),u):t,u.median=(...e)=>e.length?(a=ne(e[0]),u):a,u.upperQuartile=(...e)=>e.length?(n=ne(e[0]),u):n,u.lowerQuartile=(...e)=>e.length?(r=ne(e[0]),u):r,u.high=(...e)=>e.length?(o=ne(e[0]),u):o,u.low=(...e)=>e.length?(s=ne(e[0]),u):s,u.width=(...e)=>e.length?(h=ne(e[0]),u):h,u.orient=(...e)=>e.length?(c=e[0],u):c,u.cap=(...e)=>e.length?(g=ne(e[0]),u):g,u},oe=()=>{let e=null,t=e=>e.x,a=e=>e.high,n=e=>e.low,r="vertical",o=ne(5);const s=function(i){const s=e||l.path();return i.forEach(function(e,l){const i=t(e,l),d=o(e,l),c=d/2,h=a(e,l),g=n(e,l);"vertical"===r?(s.moveTo(i-c,h),s.lineTo(i+c,h),s.moveTo(i,h),s.lineTo(i,g),s.moveTo(i-c,g),s.lineTo(i+c,g)):(s.moveTo(g,i-c),s.lineTo(g,i+c),s.moveTo(g,i),s.lineTo(h,i),s.moveTo(h,i-c),s.lineTo(h,i+c))}),e?null:s.toString()};return s.context=(...t)=>t.length?(e=t[0],s):e,s.value=(...e)=>e.length?(t=ne(e[0]),s):t,s.high=(...e)=>e.length?(a=ne(e[0]),s):a,s.low=(...e)=>e.length?(n=ne(e[0]),s):n,s.width=(...e)=>e.length?(o=ne(e[0]),s):o,s.orient=(...e)=>e.length?(r=e[0],s):r,s},se=e=>"function"==typeof e?e:()=>e;const ce=1e-6;var he=(e,t)=>{e=e||"g";let a=(e,t)=>t,n=null;const i=function(i,r){r=r||(e=>e);const l=i.selection?i:null;l&&(i=i.selection());const d=i.selectAll((e,t,a)=>Array.from(a[t].childNodes).filter(e=>1===e.nodeType)).filter(null==t?e:`${e}.${t}`);let o=d.data(r,a);const s=o.enter().append(e).attr("class",t);let c=o.exit();o=o.merge(s);const h=l||n;return h&&(o=o.transition(h).style("opacity",1),s.style("opacity",ce),c=c.transition(h).style("opacity",ce)),c.remove(),o.enter=()=>s,o.exit=()=>c,o};return i.element=(...t)=>t.length?(e=t[0],i):e,i.className=(...e)=>e.length?(t=e[0],i):t,i.key=(...e)=>e.length?(a=e[0],i):a,i.transition=(...e)=>e.length?(n=e[0],i):n,i};const ge=(e,t)=>!(e.x>=t.x+t.width||e.x+e.width<=t.x||e.y>=t.y+t.height||e.y+e.height<=t.y);var ue=(e,t)=>{if(ge(e,t)){const a=M(e.x,t.x),n=H(e.x+e.width,t.x+t.width),i=M(e.y,t.y),r=H(e.y+e.height,t.y+t.height);return(n-a)*(r-i)}return 0};const fe=(e,a)=>t.sum(e.map((t,n)=>a===n?0:ue(e[a],t))),pe=(e,t,a,n,i)=>({x:e,y:t,width:a,height:n,location:i});var me=e=>{const t=e.x,a=e.y,n=e.width,i=e.height;return[pe(t,a,n,i,"bottom-right"),pe(t-n,a,n,i,"bottom-left"),pe(t-n,a-i,n,i,"top-left"),pe(t,a-i,n,i,"top-right"),pe(t,a-i/2,n,i,"middle-right"),pe(t-n/2,a,n,i,"bottom-center"),pe(t-n,a-i/2,n,i,"middle-left"),pe(t-n/2,a-i,n,i,"top-center")]};const ye=(e,t,a)=>[...e.slice(0,t),a,...e.slice(t+1)],xe=(e,t)=>e<t,be=()=>{let e,a=null,n=xe,l=()=>0;const d=(t,n)=>a-l(e[n],n,e)+l(t,n,ye(e,n,t)),o=(i,r)=>{a||(a=t.sum(e.map((t,a)=>l(t,a,e))));const s=d(i,r);return n(s,a)?be().locationScore(l).winningScore(n).score(s).rectangles(ye(e,r,i)):o};return o.rectangles=(...t)=>t.length?(e=t[0],o):e,o.score=(...e)=>e.length?(a=e[0],o):a,o.winningScore=(...e)=>e.length?(n=e[0],o):n,o.locationScore=(...e)=>e.length?(l=e[0],o):l,o};const ve=e=>e[Se(e)],Se=e=>O(Math.random()*e.length);const we=(e,a)=>e[t.scan(e,a)];var Ve=e=>"function"==typeof e?e:()=>e,ke=(e,t)=>"left"===e?t/2:"right"===e?-t/2:0,Ee=e=>{const t=Object.assign({},e),a=()=>{};return Object.keys(t).forEach(e=>{a[e]=(...n)=>n.length?(t[e]=n[0],a):t[e]}),a},Ae=()=>{let e=()=>0,t=e=>e.x,n=e=>e.y,r="center",l=()=>5,o="vertical";const s=Ee({decorate:()=>{},defined:(a,r)=>L(e,t,n)(a,r),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return s.values=(a,d)=>{const i=l(a,d),c=ke(r,i),h=s.xScale(),g=s.yScale();if("vertical"===o){const r=g(n(a,d),d),l=g(e(a,d),d),o=h(t(a,d),d)+c;return{d:a,x:o,y:r,y0:l,width:i,height:r-l,origin:[o,r],baseOrigin:[o,l],transposedX:o,transposedY:r}}else{const r=h(n(a,d),d),l=h(e(a,d),d),o=g(t(a,d),d)+c;return{d:a,x:o,y:r,y0:l,width:i,height:r-l,origin:[r,o],baseOrigin:[l,o],transposedX:r,transposedY:o}}},s.xValues=()=>"vertical"===o?[t]:[e,n],s.yValues=()=>"vertical"===o?[e,n]:[t],s.baseValue=(...t)=>t.length?(e=Ve(t[0]),s):e,s.crossValue=(...e)=>e.length?(t=Ve(e[0]),s):t,s.mainValue=(...e)=>e.length?(n=Ve(e[0]),s):n,s.bandwidth=(...e)=>e.length?(l=Ve(e[0]),s):l,s.align=(...e)=>e.length?(r=e[0],s):r,s.orient=(...e)=>e.length?(o=e[0],s):o,s};var Te={red:"#c60",green:"#6c0",black:"#000",gray:"#ddd",darkGray:"#999"},Ie=()=>{const e=Ae(),t=s.line().x((t,a)=>e.values(t,a).transposedX).y((t,a)=>e.values(t,a).transposedY),a=he("path","line"),n=n=>{n.selection&&a.transition(n),t.defined(e.defined()),n.each((n,i,r)=>{const l=a(o.select(r[i]),[n]);l.enter().attr("fill","none").attr("stroke",Te.black),l.attr("d",t),e.decorate()(l,n,i)})};return X(n,e,J("baseValue","bandwidth","align")),q(n,a,"key"),q(n,t,"curve"),n},_e=()=>{const e=Ae(),t=s.line().x((t,a)=>e.values(t,a).transposedX).y((t,a)=>e.values(t,a).transposedY),a=a=>{const n=t.context();n.beginPath(),n.strokeStyle=Te.black,n.fillStyle="transparent",e.decorate()(n,a),t.defined(e.defined())(a),n.fill(),n.stroke(),n.closePath()};return X(a,e,J("baseValue","bandwidth","align")),q(a,t,"curve","context"),a},Be=e=>e.copy.toString()===W.scaleIdentity().copy.toString(),Pe=()=>{const e={},t={};let a=null;const n=(n,i,r)=>{Object.keys(e).forEach(t=>{e[t](n,i,t,r)}),Object.keys(t).forEach(e=>{t[e](n,i,e)}),null!==a&&a(n)};return n.attribute=(...t)=>1===t.length?e[t[0]]:(e[t[0]]=t[1],n),n.uniform=(...e)=>1===e.length?t[e[0]]:(t[e[0]]=e[1],n),n.elementIndices=(...e)=>e.length?(a=e[0],n):a,n};const Ce={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,FLOAT:5126};var Ne=()=>{let e=null,t=1,a=Ce.FLOAT,n=!1,i=0,r=0,l=!0,d=0;const o=(o,s,c)=>{null!=e&&o.isBuffer(e)||(e=o.createBuffer(),l=!0),o.bindBuffer(o.ARRAY_BUFFER,e);const h=o.getAttribLocation(s,c);o.vertexAttribPointer(h,t,a,n,i,r),o.enableVertexAttribArray(h);const g=o.getExtension("ANGLE_instanced_arrays");g.vertexAttribDivisorANGLE(h,d)};return o.hasPropertyChanged=(...e)=>e.length?(l=e[0],o):l,o.buffer=(...t)=>t.length?(e=t[0],l=!0,o):e,o.size=(...e)=>e.length?(t=e[0],l=!0,o):t,o.type=(...e)=>e.length?(a=e[0],l=!0,o):a,o.normalized=(...e)=>e.length?(n=e[0],l=!0,o):n,o.stride=(...e)=>e.length?(i=e[0],l=!0,o):i,o.offset=(...e)=>e.length?(r=e[0],l=!0,o):r,o.divisor=(...e)=>e.length?(d=e[0],o):d,o},Re=e=>{let t=e,a=!0,n=(e,a,n)=>{const i=e.getUniformLocation(a,n);if(t instanceof Array)switch(t.length){case 1:e.uniform1fv(i,t);break;case 2:e.uniform2fv(i,t);break;case 3:e.uniform3fv(i,t);break;case 4:e.uniform4fv(i,t);break;default:throw new Error(`Uniform supports up to 4 elements. ${t.length} provided.`);}else e.uniform1f(i,t)};const i=(e,t,i)=>{a&&(a=!1,n(e,t,i))};return i.bind=(...e)=>e.length?(n=e[0],i):n,i.data=(...e)=>e.length?(t=e[0],a=!0,i):t,i},De=e=>{function t(e,t){e.push(t)}function a(e,t,a){const n=e.indexOf(a);e.splice(0<=n?n:e.length,0,t)}function n(e,t){const a=e.indexOf(t);-1===a&&e.push(t)}const i=[],r=[],l=()=>e(i.join("\n"),r.join("\n"));return l.appendHeader=e=>(t(i,e),l),l.insertHeader=(e,t)=>(a(i,e,t),l),l.appendHeaderIfNotExists=e=>(n(i,e),l),l.appendBody=e=>(t(r,e),l),l.insertBody=(e,t)=>(a(r,e,t),l),l.appendBodyIfNotExists=e=>(n(r,e),l),l};const Le=(e,t)=>`
precision mediump float;
float inf = 1.0 / 0.0;
${e}
void main() {
    ${t}
}`,ze=(e,t)=>`
precision mediump float;
${e}
void main() {
    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
    ${t}
}`;var Oe={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},He=()=>{function e(e,t,a){if(!e)return!0;const i=n.getAttachedShaders(e),r=n.getShaderSource(i[0]),l=n.getShaderSource(i[1]);return t!==r||a!==l}function t(e,t){const i=a(e,n.VERTEX_SHADER),r=a(t,n.FRAGMENT_SHADER),l=n.createProgram();if(n.attachShader(l,i),n.attachShader(l,r),n.linkProgram(l),!n.getProgramParameter(l,n.LINK_STATUS)){const a=n.getProgramInfoLog(l);throw n.deleteProgram(l),new Error(`Failed to link program : ${a}
            Vertex Shader : ${e}
            Fragment Shader : ${t}`)}return l}function a(e,t){const a=n.createShader(t);if(n.shaderSource(a,e),n.compileShader(a),!n.getShaderParameter(a,n.COMPILE_STATUS)){const t=n.getShaderInfoLog(a);throw n.deleteShader(a),new Error(`Failed to compile shader : ${t}
            Shader : ${e}`)}return a}let n=null,i=null,r=null,l=null,d=Oe.TRIANGLES,o=Pe();const s=a=>{const s=r(),c=l();e(i,s,c)&&(n.isProgram(i)&&n.deleteProgram(i),i=t(s,c)),n.useProgram(i),o.uniform("uScreen",Re([n.canvas.width,n.canvas.height])),o(n,i,a);var h=n.getExtension("ANGLE_instanced_arrays");if(d!==Oe.POINTS&&d!==Oe.TRIANGLES)throw Error(`Expected mode TRIANGLES (${Oe.TRIANGLES}) or POINTS (${Oe.POINTS}). ${d} received instead.`);if(null!==o.elementIndices())h.drawElementsInstancedANGLE(d,o.elementIndices().data().length,n.UNSIGNED_SHORT,0,a);else if(d===Oe.POINTS)n.drawArrays(d,0,a);else if(d===Oe.TRIANGLES)throw Error("Element indices must be provided for drawMode TRIANGLES.")};return s.context=(...e)=>e.length?(n=e[0],s):n,s.buffers=(...e)=>e.length?(o=e[0],s):o,s.vertexShader=(...e)=>e.length?(r=e[0],s):r,s.fragmentShader=(...e)=>e.length?(l=e[0],s):l,s.mode=(...e)=>e.length?(d=e[0],s):d,s},Ge=()=>{let e=[0,1],t=[-1,1],a=0;const n=()=>{};return n.domain=(...t)=>t.length?(e=t[0],n):e,n.range=(...e)=>e.length?(t=e[0],n):t,n.coordinate=(...e)=>e.length?(a=e[0],n):a,n},Ue=()=>{function e(e){e.vertexShader().appendHeader(`uniform vec4 ${a()}Offset;`).appendHeader(`uniform vec4 ${a()}Scale;`),n.scaleComponent(e,"gl_Position")}const t=Ge(),a=()=>`linear${t.coordinate()}`,n=n=>{e(n);const i=t.domain()[1]-t.domain()[0],r=t.range()[1]-t.range()[0],l=t.range()[0]*(i/r)-t.domain()[0],d=[0,0,0,0],o=[1,1,1,1];d[t.coordinate()]=l,o[t.coordinate()]=r/i,n.buffers().uniform(`${a()}Offset`,Re(d)).uniform(`${a()}Scale`,Re(o))};return n.scaleComponent=(e,t)=>(e.vertexShader().appendBody(`${t} = ${t} + ${a()}Offset;`).appendBody(`${t} = ${t} * ${a()}Scale;`),n),X(n,t),n},Me=()=>{function e(e,t){var a=Math.log10;return a(e)/a(t)}function t(e){e.vertexShader().appendHeader(`uniform vec4 ${i()}Offset;`).appendHeader(`uniform vec4 ${i()}Scale;`).appendHeader(`uniform vec4 ${i()}Include;`).appendHeader(`uniform float ${i()}Base;`),r.scaleComponent(e,"gl_Position")}const a=Ge();let n=10;const i=()=>`log${a.coordinate()}`,r=r=>{t(r);const l=e(a.domain()[1],n)-e(a.domain()[0],n),d=a.range()[1]-a.range()[0],o=d/l,s=a.range()[0]-o*e(a.domain()[0],n),c=[0,0,0,0],h=[0,0,0,0],g=[0,0,0,0];c[a.coordinate()]=s,h[a.coordinate()]=o,g[a.coordinate()]=1,r.buffers().uniform(`${i()}Offset`,Re(c)).uniform(`${i()}Scale`,Re(h)).uniform(`${i()}Include`,Re(g)).uniform(`${i()}Base`,Re(n))};return r.scaleComponent=(e,t)=>{const a=`${i()}Offset + (${i()}Scale * clamp(log(${t}) / log(${i()}Base), -inf, inf))`;return e.vertexShader().appendBody(`${t} = (${i()}Include * (${a})) + ((1.0 - ${i()}Include) * ${t});`),r},r.base=(...e)=>e.length?(n=e[0],r):n,X(r,a),r},Fe=()=>{function e(t,a){var e=Math.pow,n=Math.sign;return n(t)*e(F(t),a)}function t(e){e.vertexShader().appendHeader(`uniform vec4 ${i()}Offset;`).appendHeader(`uniform vec4 ${i()}Scale;`).appendHeader(`uniform vec4 ${i()}Include;`).appendHeader(`uniform float ${i()}Exp;`),r.scaleComponent(e,"gl_Position")}const a=Ge();let n=1;const i=()=>`pow${a.coordinate()}`,r=r=>{t(r);const l=e(a.domain()[1],n)-e(a.domain()[0],n),d=a.range()[1]-a.range()[0],o=d/l,s=a.range()[0]-o*e(a.domain()[0],n),c=[0,0,0,0],h=[0,0,0,0],g=[0,0,0,0];c[a.coordinate()]=s,h[a.coordinate()]=o,g[a.coordinate()]=1,r.buffers().uniform(`${i()}Offset`,Re(c)).uniform(`${i()}Scale`,Re(h)).uniform(`${i()}Include`,Re(g)).uniform(`${i()}Exp`,Re(n))};return r.scaleComponent=(e,t)=>{const a=`${i()}Offset + (${i()}Scale * sign(${t}) * pow(abs(gl_Position), vec4(${i()}Exp)))`;return e.vertexShader().appendBody(`${t} = (${i()}Include * (${a})) + ((1.0 - ${i()}Include) * ${t});`),r},r.exponent=(...e)=>e.length?(n=e[0],r):n,X(r,a),r},We=e=>{let t=W.scaleIdentity(),a=null;const n=e.copy.toString();return n===W.scaleLinear().copy.toString()?a=Ue().domain(e.domain()):n===W.scaleLog().copy.toString()?a=Me().domain(e.domain()).base(e.base()):n===W.scalePow().copy.toString()?a=Fe().domain(e.domain()).exponent(e.exponent()):n===W.scaleTime().copy.toString()?a=Ue().domain(e.domain()):(a=Ue().domain(e.range()),t=e),{scale:t,glScale:a}};const Ye={header:`attribute vec4 aColor;
             varying vec4 vColor;`,body:`vColor = aColor;`},Qe={header:`
        attribute float aCrossValue;
        attribute float aMainValue;
        attribute float aSize;
        attribute float aDefined;

        uniform float uStrokeWidth;

        varying float vSize;
        varying float vDefined;`,body:`
        vDefined = aDefined;
        vSize = 2.0 * sqrt(aSize / 3.14159);
        gl_PointSize = vSize + uStrokeWidth + 1.0;
        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);`},qe={header:`
        attribute float aCrossValue;
        attribute float aMainValue;
        attribute float aSize;
        attribute float aDefined;

        uniform float uStrokeWidth;

        varying float vSize;
        varying float vDefined;`,body:`
        vDefined = aDefined;
        vSize = sqrt(aSize);
        gl_PointSize = vSize + uStrokeWidth + 1.0;
        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);`},je={header:`
        attribute float aCrossValue;
        attribute float aMainValue;
        attribute float aSize;
        attribute float aDefined;

        uniform float uStrokeWidth;

        varying float vSize;
        varying float vDefined;`,body:`
        vDefined = aDefined;
        vSize = sqrt((16.0 * aSize) / (3.0 * sqrt(3.0)));
        gl_PointSize = vSize + uStrokeWidth + 1.0;
        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);`},Xe={header:`
        attribute float aCrossValue;
        attribute float aMainValue;
        attribute float aSize;
        attribute float aDefined;

        uniform float uStrokeWidth;

        varying float vSize;
        varying float vStrokeWidthRatio;
        varying float vDefined;`,body:`
        vDefined = aDefined;
        vSize = 3.0 * sqrt(aSize / 5.0);
        vStrokeWidthRatio = uStrokeWidth / (vSize + uStrokeWidth + 1.0);
        gl_PointSize = vSize + uStrokeWidth + 1.0;
        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);`},Ke={header:`
        attribute float aCrossValue;
        attribute float aBandwidth;
        attribute float aHighValue;
        attribute float aOpenValue;
        attribute float aCloseValue;
        attribute float aLowValue;
        attribute vec3 aCorner;
        attribute float aDefined;
    
        uniform vec2 uScreen;
        uniform float uStrokeWidth;
        
        varying float vColorIndicator;
        varying float vDefined;`,body:`
        vDefined = aDefined;
        vColorIndicator = sign(aCloseValue - aOpenValue);

        float isPositiveY = (sign(aCorner.y) + 1.0) / 2.0;
        float isNotPositiveY = 1.0 - isPositiveY;
        float isExtremeY = abs(aCorner.y) - 1.0;
        float isNotExtremeY = 1.0 - isExtremeY;
        float yValue =
         (isPositiveY * isExtremeY * aLowValue) + 
         (isPositiveY * isNotExtremeY * aCloseValue) +
         (isNotPositiveY * isNotExtremeY * aOpenValue) +
         (isNotPositiveY * isExtremeY * aHighValue);

        float lineWidthXDirection = (isNotExtremeY * aCorner.x) + (isExtremeY * aCorner.z);
        float lineWidthYDirection = isNotExtremeY * sign(aCloseValue - aOpenValue) * aCorner.y;

        float bandwidthModifier = aBandwidth * aCorner.x / 2.0;

        float xModifier = (uStrokeWidth * lineWidthXDirection / 2.0) + bandwidthModifier;
        float yModifier = uStrokeWidth * lineWidthYDirection / 2.0;

        gl_Position = vec4(aCrossValue, yValue, 0, 1);`},Je={header:`
        attribute float aCrossValue;
        attribute float aBandwidth;
        attribute float aHighValue;
        attribute float aOpenValue;
        attribute float aCloseValue;
        attribute float aLowValue;
        attribute vec3 aCorner;
        attribute float aDefined;

        uniform vec2 uScreen;
        uniform float uStrokeWidth;

        varying float vColorIndicator;
        varying float vDefined;`,body:`
        vDefined = aDefined;
        vColorIndicator = sign(aCloseValue - aOpenValue);

        float isPositiveY = (sign(aCorner.y) + 1.0) / 2.0;
        float isNotPositiveY = 1.0 - isPositiveY;
        float isExtremeY = abs(aCorner.y) - 1.0;
        float isNotExtremeY = 1.0 - isExtremeY;
        float yValue = 
            (isPositiveY * isExtremeY * aLowValue) + 
            (isPositiveY * isNotExtremeY * aCloseValue) +
            (isNotPositiveY * isNotExtremeY * aOpenValue) +
            (isNotPositiveY * isExtremeY * aHighValue);

        float lineWidthXDirection = isExtremeY * aCorner.z;
        float lineWidthYDirection = isNotExtremeY * aCorner.z;

        float bandwidthModifier = isNotExtremeY * aCorner.x * aBandwidth / 2.0;

        float xModifier = (uStrokeWidth * lineWidthXDirection / 2.0) + bandwidthModifier;
        float yModifier = uStrokeWidth * lineWidthYDirection / 2.0;

        gl_Position = vec4(aCrossValue, yValue, 0, 1);`},Ze={header:`
        attribute float aCrossValue;
        attribute float aBandwidth;
        attribute float aMainValue;
        attribute float aBaseValue;
        attribute vec2 aCorner;
        attribute float aDefined;
        
        uniform vec2 uScreen;
        uniform float uStrokeWidth;
        
        varying float vDefined;`,body:`
        vDefined = aDefined;
        float isBaseline = (1.0 - aCorner.y) / 2.0;
        float yValue = (isBaseline * aBaseValue) + ((1.0 - isBaseline) * aMainValue);

        float xModifier = aCorner.x * (aBandwidth) / 2.0;

        gl_Position = vec4(aCrossValue, yValue, 0, 1);`},$e={header:`
        attribute vec3 aCorner;
        attribute float aCrossNextValue;
        attribute float aMainNextValue;
        attribute float aCrossValue;
        attribute float aMainValue;
        attribute float aCrossPrevValue;
        attribute float aMainPrevValue;
        attribute float aCrossPrevPrevValue;
        attribute float aMainPrevPrevValue;
        attribute float aDefined;
        
        uniform float uStrokeWidth;
        uniform vec2 uScreen;

        varying float vDefined;`,body:`
        vDefined = aDefined;
        vec4 next = vec4(aCrossNextValue, aMainNextValue, 0, 0);
        gl_Position = vec4(aCrossValue, aMainValue, 0, 1);
        vec4 prev = vec4(aCrossPrevValue, aMainPrevValue, 0, 0);
        vec4 prevPrev = vec4(aCrossPrevPrevValue, aMainPrevPrevValue, 0, 0);`},et={body:`
        vec4 prevVertexPosition = gl_Position;
        vec4 currVertexPosition = gl_Position;
        
        if (all(equal(prev.xy, prevPrev.xy))) {
            prevPrev.xy = prev.xy + normalize(prev.xy - prevVertexPosition.xy);
        }
        if (all(equal(prev.xy, prevVertexPosition.xy))) {
            prevVertexPosition.xy = prev.xy + normalize(prev.xy - prevPrev.xy);
        }
        vec2 A = normalize(normalize(prev.xy - prevPrev.xy) * uScreen);
        vec2 B = normalize(normalize(prevVertexPosition.xy - prev.xy) * uScreen);
        vec2 tangent = normalize(A + B);
        vec2 miter = vec2(-tangent.y, tangent.x);
        vec2 normalA = vec2(-A.y, A.x);
        float miterLength = 1.0 / dot(miter, normalA);
        vec2 point = normalize(A - B);
        if (miterLength > 10.0 && sign(aCorner.x * dot(miter, point)) > 0.0) {
            prevVertexPosition.xy = prev.xy - (aCorner.x * aCorner.y * uStrokeWidth * normalA) / uScreen.xy;
        } else {
            prevVertexPosition.xy = prev.xy + (aCorner.x * miter * uStrokeWidth * miterLength) / uScreen.xy;
        }

        if (all(equal(currVertexPosition.xy, prev.xy))) {
            prev.xy = currVertexPosition.xy + normalize(currVertexPosition.xy - next.xy);
        }
        if (all(equal(currVertexPosition.xy, next.xy))) {
            next.xy = currVertexPosition.xy + normalize(currVertexPosition.xy - prev.xy);
        }
        vec2 C = normalize(normalize(currVertexPosition.xy - prev.xy) * uScreen);
        vec2 D = normalize(normalize(next.xy - currVertexPosition.xy) * uScreen);
        vec2 tangentCD = normalize(C + D);
        vec2 miterCD = vec2(-tangentCD.y, tangentCD.x);
        vec2 normalC = vec2(-C.y, C.x);
        float miterCDLength = 1.0 / dot(miterCD, normalC);
        vec2 pointCD = normalize(C - D);
        if (miterCDLength > 10.0 && sign(aCorner.x * dot(miterCD, pointCD)) > 0.0) {
            currVertexPosition.xy = currVertexPosition.xy - (aCorner.x * aCorner.y * uStrokeWidth * normalC) / uScreen.xy;
        } else {
            currVertexPosition.xy = currVertexPosition.xy + (aCorner.x * miterCD * uStrokeWidth * miterCDLength) / uScreen.xy;
        }
        
        gl_Position.xy = ((1.0 - aCorner.z) * prevVertexPosition.xy) + (aCorner.z * currVertexPosition.xy);`},tt={header:`
        attribute vec3 aCorner;
        attribute float aCrossValue;
        attribute float aBandwidth;
        attribute float aHighValue;
        attribute float aLowValue;
        attribute float aDefined;

        uniform vec2 uScreen;
        uniform float uStrokeWidth;
        
        varying float vDefined;`,body:`
        vDefined = aDefined;
        float isLow = (aCorner.y + 1.0) / 2.0;
        float yValue = isLow * aLowValue + (1.0 - isLow) * aHighValue;

        float isEdgeCorner = abs(aCorner.x);
        float lineWidthXDirection = (1.0 - isEdgeCorner) * aCorner.z;
        float lineWidthYDirection = isEdgeCorner * aCorner.z;
        
        gl_Position = vec4(aCrossValue, yValue, 0, 1);
        
        float xModifier = (uStrokeWidth * lineWidthXDirection) + (aBandwidth * aCorner.x / 2.0);
        float yModifier = (uStrokeWidth * lineWidthYDirection);`},at={header:`
        attribute vec3 aCorner;
        attribute float aCrossValue;
        attribute float aMainValue;
        attribute float aCrossPrevValue;
        attribute float aMainPrevValue;
        attribute float aBaseValue;
        attribute float aBasePrevValue;
        attribute float aDefined;

        varying float vDefined;
        
        float when_lt(float a, float b) {
            return max(sign(b - a), 0.0);
        }
        
        float and(float a, float b) {
            return a * b;
        }`,body:`
        vDefined = aDefined;
        gl_Position = vec4(0, 0, 0, 1);

        float hasIntercepted = when_lt((aMainValue - aBaseValue) * (aMainPrevValue - aBasePrevValue), 0.0);
        float useIntercept = and(aCorner.z, hasIntercepted);
        
        float yGradient = (aMainValue - aMainPrevValue) / (aCrossValue - aCrossPrevValue);
        float yConstant = aMainValue - (yGradient * aCrossValue);

        float y0Gradient = (aBaseValue - aBasePrevValue) / (aCrossValue - aCrossPrevValue);
        float y0Constant = aBaseValue - (y0Gradient * aCrossValue);

        float denominator = (yGradient - y0Gradient) + step(abs(yGradient - y0Gradient), 0.0);
        float interceptXValue = (y0Constant - yConstant) / denominator;
        float interceptYValue = (yGradient * interceptXValue) + yConstant;

        gl_Position = vec4(interceptXValue * useIntercept, interceptYValue * useIntercept, 0, 1);
        
        gl_Position.x += (1.0 - useIntercept) * ((aCorner.x * aCrossValue) + ((1.0 - aCorner.x) * aCrossPrevValue));
        gl_Position.y += (1.0 - useIntercept) * (1.0 - aCorner.y) * ((aCorner.x * aMainValue) + ((1.0 - aCorner.x) * aMainPrevValue));
        gl_Position.y += (1.0 - useIntercept) * aCorner.y * ((aCorner.x * aBaseValue) + ((1.0 - aCorner.x) * aBasePrevValue));`},nt={header:`
        attribute vec4 aCorner;
        attribute float aCrossValue;
        attribute float aBandwidth;
        attribute float aCap;
        attribute float aHighValue;
        attribute float aUpperQuartileValue;
        attribute float aMedianValue;
        attribute float aLowerQuartileValue;
        attribute float aLowValue;
        attribute float aDefined;

        uniform vec2 uScreen;
        uniform float uStrokeWidth;
        
        varying float vDefined;`,body:`
        vDefined = aDefined;
        float isExtremeY = sign(abs(aCorner.y) - 2.0) + 1.0;
        float isNotExtremeY = 1.0 - isExtremeY;

        float isNonZeroY = abs(sign(aCorner.y));
        float isZeroY = 1.0 - isNonZeroY;

        float isQuartileY = isNotExtremeY * isNonZeroY;

        float isPositiveY = (sign(aCorner.y + 0.5) + 1.0) / 2.0;
        float isNegativeY = 1.0 - isPositiveY;

        float yValue =
          (isExtremeY * isNegativeY) * aHighValue +
          (isQuartileY * isNegativeY) * aUpperQuartileValue +
          isZeroY * aMedianValue +
          (isQuartileY * isPositiveY) * aLowerQuartileValue +
          (isExtremeY * isPositiveY) * aLowValue;

        gl_Position = vec4(aCrossValue, yValue, 0, 1);

        float isHorizontal = aCorner.w;
        float isVertical = 1.0 - isHorizontal;

        float xDisplacement = aCorner.x * (isExtremeY * aCap + isNotExtremeY * aBandwidth) / 2.0;
        
        float xModifier = (isVertical * uStrokeWidth * aCorner.z / 2.0) + xDisplacement;
        float yModifier = isHorizontal * uStrokeWidth * aCorner.z / 2.0;`};var it=Object.freeze({scale:{header:`uniform vec2 uScale;`,body:`gl_Position.xy = gl_Position.xy * uScale;`},translate:{header:`uniform vec2 uTranslate;`,body:`gl_Position.xy = gl_Position.xy + uTranslate;`},multiColor:Ye,circle:Qe,square:qe,triangle:je,cross:Xe,candlestick:Ke,ohlc:Je,bar:Ze,preScaleLine:$e,postScaleLine:et,errorBar:tt,area:at,boxPlot:nt});const rt={header:`
        varying float vSize;
        varying float vDefined;`,body:`
        float distance = length(2.0 * gl_PointCoord - 1.0);
        if (distance > 1.0 || vDefined < 0.5) {
            discard;
            return;
        }`},lt={header:`
        varying float vSize;
        varying float vDefined;`,body:`
        if (vDefined < 0.5) {
            discard;
        }
        vec2 pointCoordTransform = 2.0 * gl_PointCoord - 1.0;
        float distance = max(abs(pointCoordTransform.x), abs(pointCoordTransform.y));`},dt={header:`
        varying float vSize;
        varying float vDefined;`,body:`
        vec2 pointCoordTransform = 2.0 * gl_PointCoord - 1.0;
        float topEdgesDistance = abs(pointCoordTransform.x) - ((pointCoordTransform.y - 0.6) / sqrt(3.0));
        float bottomEdgeDistance = pointCoordTransform.y + 0.5;
        float distance = max(topEdgesDistance, bottomEdgeDistance);
        if (distance > 1.0 || vDefined < 0.5) {
            discard;
        }`},ot={header:`
        varying float vSize;
        varying float vStrokeWidthRatio;
        varying float vDefined;`,body:`
        vec2 pointCoordTransform = 2.0 * gl_PointCoord - 1.0;
        float innerCornerDistance = min(abs(pointCoordTransform.x), abs(pointCoordTransform.y)) + 0.66 - vStrokeWidthRatio;
        float outerEdgeDistance = max(abs(pointCoordTransform.x), abs(pointCoordTransform.y));
        float distance = max(innerCornerDistance, outerEdgeDistance);
        if (distance > 1.0 || vDefined < 0.5) {
            discard;
        }`},st={header:`
        varying float vColorIndicator;
        varying float vDefined;`,body:`
        if (vDefined < 0.5) {
            discard;
        }
        gl_FragColor = vec4(0.4, 0.8, 0, 1);
        if (vColorIndicator < 0.0) {
            gl_FragColor = vec4(0.8, 0.4, 0, 1);
        }`},ct={header:`
        varying float vColorIndicator;
        varying float vDefined;`,body:`
        if (vDefined < 0.5) {
            discard;
        }
        gl_FragColor = vec4(0.4, 0.8, 0, 1);
        if (vColorIndicator < 0.0) {
            gl_FragColor = vec4(0.8, 0.4, 0, 1);
        }`},ht={header:`varying float vDefined;`,body:`if (vDefined < 0.5) {
            discard;
        }
        gl_FragColor = vec4(0.86, 0.86, 0.86, 1);`},gt={header:`varying float vDefined;`,body:`
        if (vDefined < 0.5) {
            discard;
        }`},ut={header:`varying float vDefined;`,body:`
        if (vDefined < 0.5) {
            discard;
        }`},ft={header:`varying float vDefined;`,body:`
        if (vDefined < 0.5) {
            discard;
        }`},pt={body:`gl_FragColor.a = gl_FragColor.a * (1.0 - smoothstep(vSize - 2.0, vSize, distance * vSize));`},mt={header:`varying vec4 vColor;`,body:`gl_FragColor = vColor;`},yt={header:`uniform vec4 uColor;`,body:`gl_FragColor = uColor;`},xt={header:`uniform vec4 uEdgeColor;
             uniform float uStrokeWidth;`,body:`float sEdge = smoothstep(vSize - uStrokeWidth - 2.0, vSize - uStrokeWidth, distance * (vSize + uStrokeWidth));
           gl_FragColor = (uEdgeColor * sEdge) + ((1.0 - sEdge) * gl_FragColor);`},bt={header:`varying float vDefined;`,body:`if (vDefined < 0.5) {
        discard;
    }`};var vt=Object.freeze({circle:rt,square:lt,triangle:dt,cross:ot,candlestick:st,ohlc:ct,area:ht,boxPlot:gt,errorBar:ut,bar:ft,pointAlias:pt,multiColor:mt,seriesColor:yt,pointEdge:xt,line:bt}),St=()=>{const e=De(Le),t=De(ze);return e.appendHeader(Qe.header).appendBody(Qe.body),t.appendHeader(rt.header).appendBody(rt.body),{vertex:()=>e,fragment:()=>t}},wt=()=>{const e=De(Le),t=De(ze);return e.appendHeader(qe.header).appendBody(qe.body),t.appendHeader(lt.header).appendBody(lt.body),{vertex:()=>e,fragment:()=>t}},Vt=()=>{const e=De(Le),t=De(ze);return e.appendHeader(je.header).appendBody(je.body),t.appendHeader(dt.header).appendBody(dt.body),{vertex:()=>e,fragment:()=>t}},kt=()=>{const e=De(Le),t=De(ze);return e.appendHeader(Xe.header).appendBody(Xe.body),t.appendHeader(ot.header).appendBody(ot.body),{vertex:()=>e,fragment:()=>t}},Et=e=>{switch(e){case Y.symbolCircle:return St();case Y.symbolSquare:return wt();case Y.symbolTriangle:return Vt();case Y.symbolCross:return kt();default:throw new Error(`Unrecognised symbol: ${e}`);}},At=()=>{let e=1;const t=t=>{t.buffers().uniform("uStrokeWidth",Re(e))};return t.lineWidth=(...a)=>a.length?(e=a[0],t):e,t},Tt=e=>{switch(e){case Ce.BYTE:return Int8Array;case Ce.UNSIGNED_BYTE:return Uint8Array;case Ce.SHORT:return Int16Array;case Ce.UNSIGNED_SHORT:return Uint16Array;case Ce.FLOAT:return Float32Array;default:throw new Error(`Unknown type ${e}`);}},It=()=>{let e=Float32Array,t=new e(0);const a=a=>(t.length>a?t=new e(t.buffer,0,a):t.length!==a&&(t=new e(a)),t);return a.type=(...n)=>n.length?(e=Tt(n[0]),t=new e(0),a):e,a},_t=()=>{const e=Ne().divisor(1),t=It();let a=(e,t)=>e[t],n=null;const i=i=>{const r=e.size(),l=e.offset(),d=t.type(e.type())(l+i*r);if(1<r)for(let e=0;e<i;e++){const t=a(n,e);for(let a=0;a<r;a++)d[l+e*r+a]=t[a]}else for(let e=0;e<i;e++)d[l+e]=a(n,e);return d},r=(t,n,r,l)=>{if(e(t,n,r),!!e.hasPropertyChanged()){if("function"==typeof a){const a=i(l);t.bindBuffer(t.ARRAY_BUFFER,e.buffer()),t.bufferData(t.ARRAY_BUFFER,a,t.DYNAMIC_DRAW)}else if(!Array.isArray(a))throw new Error(`Expected function or array, received: ${a}`);else if(a.length===e.size()){const e=t.getAttribLocation(n,r);t[`vertexAttrib${a.length}fv`](e,a),t.disableVertexAttribArray(e)}else throw new Error(`Expected array of length: ${e.size()}, recieved array of length: ${a.length}`);e.hasPropertyChanged(!1)}};return r.value=(...t)=>t.length?(a=t[0],e.hasPropertyChanged(!0),r):a,r.data=(...t)=>t.length?(n=t[0],e.hasPropertyChanged(!0),r):n,X(r,e,J("buffer")),r},Bt=()=>{const e=He();let t=Ge(),a=Ge(),n=St(),i=()=>{};const r=_t().divisor(0),l=_t().divisor(0),d=_t().divisor(0).type(Ce.UNSIGNED_SHORT),o=_t().divisor(0).type(Ce.UNSIGNED_BYTE),s=s=>{e.vertexShader(n.vertex()).fragmentShader(n.fragment()).mode(Oe.POINTS),e.buffers().attribute("aCrossValue",r).attribute("aMainValue",l).attribute("aSize",d).attribute("aDefined",o),t.coordinate(0),t(e),a.coordinate(1),a(e),i(e),e(s)};return s.xValues=e=>(r.data(e),s),s.yValues=e=>(l.data(e),s),s.sizes=e=>(d.data(e),s),s.defined=e=>(o.data(e),s),s.decorate=(...e)=>e.length?(i=e[0],s):i,s.xScale=(...e)=>e.length?(t=e[0],s):t,s.yScale=(...e)=>e.length?(a=e[0],s):a,s.type=(...e)=>e.length?(n=e[0],s):n,q(s,e,"context"),s},Pt=()=>{const e=De(Le),t=De(ze);return e.appendHeader($e.header).appendBody($e.body),t.appendHeader(bt.header).appendBody(bt.body),{vertex:()=>e,fragment:()=>t}},Ct=()=>{const e=Ne(),t=It();let a=null;const n=()=>{const n=e.size(),i=e.offset(),r=a.length*n,l=t.type(e.type())(i+r);let d=0;for(let e=0;e<a.length;e++){if(a[e].length!==n)throw new Error(`Expected components array of size ${n}, recieved array with length ${a[e].length}.`);for(let t=0;t<n;t++)l[i+d]=a[e][t],d++}return l},i=(t,a,i)=>{if(e(t,a,i),!!e.hasPropertyChanged()){const a=n();t.bufferData(t.ARRAY_BUFFER,a,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,e.buffer()),e.hasPropertyChanged(!1)}};return i.data=(...t)=>t.length?(a=t[0],e.hasPropertyChanged(!0),i):a,X(i,e,J("buffer")),i},Nt=()=>{let e=null,t=null,a=!1;const n=n=>{a&&(null==e&&(e=n.createBuffer()),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e),n.bufferData(n.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),n.STATIC_DRAW))};return n.buffer=(...t)=>t.length?(e=t[0],n):e,n.data=(...e)=>e.length?(a=!0,t=e[0],n):t,n},Rt=()=>{let e=Ge(),t=Ge(),a=()=>{};const n=At(),i=_t().value((e,t)=>e[H(t+1,e.length-1)]),r=_t().value((e,t)=>e[H(t+2,e.length-1)]),l=_t(),d=_t().value((e,t)=>e[M(t-1,0)]),o=_t().value((e,t)=>e[H(t+1,e.length-1)]),s=_t().value((e,t)=>e[H(t+2,e.length-1)]),c=_t(),h=_t().value((e,t)=>e[M(t-1,0)]),g=Ct().size(3).type(Ce.BYTE).data([[-1,0,0],[1,1,0],[1,-1,1],[-1,0,1],[1,1,1]]),u=_t().type(Ce.UNSIGNED_BYTE).value((e,t)=>{const a=e[t],n=t===e.length-1?0:e[t+1];return a?n:a}),f=Nt().data([0,1,2,1,2,3,0,2,3,2,3,4]),p=He().mode(Oe.TRIANGLES);p.buffers().elementIndices(f).attribute("aCrossValue",i).attribute("aCrossNextValue",r).attribute("aCrossPrevValue",l).attribute("aCrossPrevPrevValue",d).attribute("aMainValue",o).attribute("aMainNextValue",s).attribute("aMainPrevValue",c).attribute("aMainPrevPrevValue",h).attribute("aCorner",g).attribute("aDefined",u);const m=i=>{const r=Pt();p.vertexShader(r.vertex()).fragmentShader(r.fragment()),e.coordinate(0),e(p),t.coordinate(1),t(p),e.scaleComponent(p,"next"),t.scaleComponent(p,"next"),e.scaleComponent(p,"prev"),t.scaleComponent(p,"prev"),e.scaleComponent(p,"prevPrev"),t.scaleComponent(p,"prevPrev"),p.vertexShader().appendBody(et.body),n(p),a(p),p(i-1)};return m.xValues=e=>(i.data(e),r.data(e),l.data(e),d.data(e),m),m.yValues=e=>(o.data(e),s.data(e),c.data(e),h.data(e),m),m.defined=e=>(u.data(e),m),m.decorate=(...e)=>e.length?(a=e[0],m):a,m.xScale=(...t)=>t.length?(e=t[0],m):e,m.yScale=(...e)=>e.length?(t=e[0],m):t,q(m,p,"context"),q(m,n,"lineWidth"),m},Dt=()=>{const e=De(Le),t=De(ze);return e.appendHeader(Je.header).appendBody(Je.body),t.appendHeader(ct.header).appendBody(ct.body),{vertex:()=>e,fragment:()=>t}},Lt=()=>{const e=He();let t=Ge(),a=Ge();const n=At();let i=()=>{};const r=_t(),l=_t(),d=_t(),o=_t(),s=_t(),c=_t().type(Ce.UNSIGNED_SHORT),h=Ct().size(3).type(Ce.BYTE).data([[0,-2,-1],[0,-2,1],[0,2,1],[0,2,-1],[-1,-1,-1],[-1,-1,1],[0,-1,1],[0,-1,-1],[1,1,1],[0,1,1],[0,1,-1],[1,1,-1]]),g=_t().type(Ce.UNSIGNED_BYTE),u=Nt().data([0,1,2,0,3,2,4,5,6,4,7,6,8,9,10,10,11,8]),f=f=>{const p=Dt();e.vertexShader(p.vertex()).fragmentShader(p.fragment()).mode(Oe.TRIANGLES),e.buffers().elementIndices(u).attribute("aCrossValue",r).attribute("aHighValue",l).attribute("aOpenValue",d).attribute("aCloseValue",o).attribute("aLowValue",s).attribute("aBandwidth",c).attribute("aCorner",h).attribute("aDefined",g),t.coordinate(0),t(e),a.coordinate(1),a(e),n(e),e.vertexShader().appendBody(`
          gl_Position.x += xModifier / uScreen.x;
          gl_Position.y += yModifier / uScreen.y;
        `),i(e),e(f)};return f.xValues=e=>(r.data(e),f),f.openValues=e=>(d.data(e),f),f.highValues=e=>(l.data(e),f),f.lowValues=e=>(s.data(e),f),f.closeValues=e=>(o.data(e),f),f.bandwidth=e=>(c.data(e),f),f.defined=e=>(g.data(e),f),f.decorate=(...e)=>e.length?(i=e[0],f):i,f.xScale=(...e)=>e.length?(t=e[0],f):t,f.yScale=(...e)=>e.length?(a=e[0],f):a,q(f,e,"context"),q(f,n,"lineWidth"),f},zt=()=>{const e=De(Le),t=De(ze);return e.appendHeader(Ze.header).appendBody(Ze.body),t.appendHeader(ft.header).appendBody(ft.body),{vertex:()=>e,fragment:()=>t}},Ot=()=>{const e=He();let t=Ge(),a=Ge(),n=()=>{};const i=_t(),r=_t(),l=_t(),d=_t().type(Ce.UNSIGNED_SHORT),o=Ct().size(2).type(Ce.BYTE).data([[-1,-1],[1,1],[-1,1],[1,-1]]),s=_t().type(Ce.UNSIGNED_BYTE),c=Nt().data([0,1,2,0,1,3]),h=h=>{const g=zt();e.vertexShader(g.vertex()).fragmentShader(g.fragment()).mode(Oe.TRIANGLES),e.buffers().elementIndices(c).attribute("aCorner",o).attribute("aCrossValue",i).attribute("aMainValue",r).attribute("aBaseValue",l).attribute("aBandwidth",d).attribute("aDefined",s),t.coordinate(0),t(e),a.coordinate(1),a(e),e.vertexShader().appendBody(`
            gl_Position.x += xModifier / uScreen.x * 2.0;
        `),n(e),e(h)};return h.xValues=e=>(i.data(e),h),h.y0Values=e=>(l.data(e),h),h.yValues=e=>(r.data(e),h),h.widths=e=>(d.data(e),h),h.defined=e=>(s.data(e),h),h.xScale=(...e)=>e.length?(t=e[0],h):t,h.yScale=(...e)=>e.length?(a=e[0],h):a,h.decorate=(...e)=>e.length?(n=e[0],h):n,q(h,e,"context"),h},Ht=()=>{const e=De(Le),t=De(ze);return e.appendHeader(tt.header).appendBody(tt.body),t.appendHeader(ut.header).appendBody(ut.body),{vertex:()=>e,fragment:()=>t}},Gt=()=>{const e=He();let t=Ge(),a=Ge(),n=()=>{};const i=At(),r=_t(),l=_t(),d=_t(),o=_t().type(Ce.UNSIGNED_SHORT),s=Ct().size(3).type(Ce.BYTE).data([[0,1,1],[0,1,-1],[0,-1,-1],[0,-1,1],[1,-1,1],[1,-1,-1],[-1,-1,-1],[-1,-1,1],[-1,1,-1],[-1,1,1],[1,1,1],[1,1,-1]]),c=_t().type(Ce.UNSIGNED_BYTE),h=Nt().data([0,1,2,0,3,2,4,5,6,4,7,6,8,9,10,8,11,10]),g=g=>{const u=Ht();e.vertexShader(u.vertex()).fragmentShader(u.fragment()).mode(Oe.TRIANGLES),e.buffers().elementIndices(h).attribute("aCrossValue",r).attribute("aHighValue",l).attribute("aLowValue",d).attribute("aBandwidth",o).attribute("aCorner",s).attribute("aDefined",c),t.coordinate(0),t(e),a.coordinate(1),a(e),i(e),e.vertexShader().appendBody(`
                gl_Position.x += xModifier / uScreen.x * 2.0;
                gl_Position.y += yModifier / uScreen.y * 2.0;
            `),n(e),e(g)};return g.xValues=e=>(r.data(e),g),g.highValues=e=>(l.data(e),g),g.lowValues=e=>(d.data(e),g),g.bandwidth=e=>(o.data(e),g),g.defined=e=>(c.data(e),g),g.xScale=(...e)=>e.length?(t=e[0],g):t,g.yScale=(...e)=>e.length?(a=e[0],g):a,g.decorate=(...e)=>e.length?(n=e[0],g):n,q(g,e,"context"),q(g,i,"lineWidth"),g},Ut=()=>{const e=De(Le),t=De(ze);return e.appendHeader(at.header).appendBody(at.body),t.appendHeader(ht.header).appendBody(ht.body),{vertex:()=>e,fragment:()=>t}},Mt=()=>{let e=Ge(),t=Ge(),a=()=>{};const n=_t().value((e,t)=>e[H(t+1,e.length-1)]),i=_t(),r=_t().value((e,t)=>e[H(t+1,e.length-1)]),l=_t(),d=_t().value((e,t)=>e[H(t+1,e.length-1)]),o=_t(),s=Ct().size(3).type(Ce.UNSIGNED_BYTE).data([[0,0,0],[0,1,0],[1,1,1],[0,0,1],[1,0,0],[1,1,0]]),c=_t().type(Ce.UNSIGNED_BYTE).value((e,t)=>{const a=e[t],n=t===e.length-1?0:e[t+1];return a?n:a}),h=Nt().data([0,1,2,3,4,5]),g=He().mode(Oe.TRIANGLES);g.buffers().elementIndices(h).attribute("aCrossValue",n).attribute("aCrossPrevValue",i).attribute("aMainValue",r).attribute("aMainPrevValue",l).attribute("aBaseValue",d).attribute("aBasePrevValue",o).attribute("aCorner",s).attribute("aDefined",c);const u=n=>{const i=Ut();g.vertexShader(i.vertex()).fragmentShader(i.fragment()),e.coordinate(0),e(g),t.coordinate(1),t(g),a(g),g(n-1)};return u.xValues=e=>(n.data(e),i.data(e),u),u.yValues=e=>(r.data(e),l.data(e),u),u.y0Values=e=>(d.data(e),o.data(e),u),u.defined=e=>(c.data(e),u),u.decorate=(...e)=>e.length?(a=e[0],u):a,u.xScale=(...t)=>t.length?(e=t[0],u):e,u.yScale=(...e)=>e.length?(t=e[0],u):t,q(u,g,"context"),u},Ft=()=>{const e=De(Le),t=De(ze);return e.appendHeader(Ke.header).appendBody(Ke.body),t.appendHeader(st.header).appendBody(st.body),{vertex:()=>e,fragment:()=>t}},Wt=()=>{const e=He();let t=Ge(),a=Ge();const n=At();let i=()=>{};const r=_t(),l=_t(),d=_t(),o=_t(),s=_t(),c=_t().type(Ce.UNSIGNED_SHORT),h=Ct().size(3).type(Ce.BYTE).data([[0,2,1],[0,2,-1],[0,-2,-1],[0,-2,1],[1,-1,0],[-1,-1,0],[-1,1,0],[1,1,0]]),g=_t().type(Ce.UNSIGNED_BYTE),u=Nt().data([0,1,2,0,3,2,4,5,6,4,7,6]),f=f=>{const p=Ft();e.vertexShader(p.vertex()).fragmentShader(p.fragment()).mode(Oe.TRIANGLES),e.buffers().elementIndices(u).attribute("aCrossValue",r).attribute("aHighValue",l).attribute("aOpenValue",d).attribute("aCloseValue",o).attribute("aLowValue",s).attribute("aBandwidth",c).attribute("aCorner",h).attribute("aDefined",g),t.coordinate(0),t(e),a.coordinate(1),a(e),n(e),e.vertexShader().appendBody(`
          gl_Position.x += xModifier / uScreen.x;
          gl_Position.y += yModifier / uScreen.y;
        `),i(e),e(f)};return f.xValues=e=>(r.data(e),f),f.openValues=e=>(d.data(e),f),f.highValues=e=>(l.data(e),f),f.lowValues=e=>(s.data(e),f),f.closeValues=e=>(o.data(e),f),f.bandwidth=e=>(c.data(e),f),f.defined=e=>(g.data(e),f),f.decorate=(...e)=>e.length?(i=e[0],f):i,f.xScale=(...e)=>e.length?(t=e[0],f):t,f.yScale=(...e)=>e.length?(a=e[0],f):a,q(f,e,"context"),q(f,n,"lineWidth"),f},Yt=()=>{const e=De(Le),t=De(ze);return e.appendHeader(nt.header).appendBody(nt.body),t.appendHeader(gt.header).appendBody(gt.body),{vertex:()=>e,fragment:()=>t}},Qt=()=>{const e=He();let t=Ge(),a=Ge(),n=()=>{};const i=At(),r=_t(),l=_t(),d=_t(),o=_t(),s=_t(),c=_t(),h=_t().type(Ce.UNSIGNED_SHORT),g=_t().type(Ce.UNSIGNED_SHORT),u=Ct().size(4).type(Ce.BYTE).data([[-1,-2,-1,1],[1,-2,-1,1],[1,-2,1,1],[-1,-2,1,1],[0,-2,-1,0],[0,-2,1,0],[0,-1,1,0],[0,-1,-1,0],[-1,-1,-1,1],[1,-1,-1,1],[1,-1,1,1],[-1,-1,1,1],[-1,0,-1,1],[1,0,-1,1],[1,0,1,1],[-1,0,1,1],[-1,1,-1,1],[1,1,-1,1],[1,1,1,1],[-1,1,1,1],[-1,-1,-1,0],[-1,-1,1,0],[-1,1,1,0],[-1,1,-1,0],[1,-1,-1,0],[1,-1,1,0],[1,1,1,0],[1,1,-1,0],[0,2,-1,0],[0,2,1,0],[0,1,1,0],[0,1,-1,0],[-1,2,-1,1],[1,2,-1,1],[1,2,1,1],[-1,2,1,1]]),f=_t().type(Ce.UNSIGNED_BYTE),p=Nt().data([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23,24,25,26,24,26,27,28,29,30,28,30,31,32,33,34,32,34,35]),m=m=>{const y=Yt();e.vertexShader(y.vertex()).fragmentShader(y.fragment()).mode(Oe.TRIANGLES),e.buffers().elementIndices(p).attribute("aCrossValue",r).attribute("aHighValue",l).attribute("aUpperQuartileValue",d).attribute("aMedianValue",o).attribute("aLowerQuartileValue",s).attribute("aLowValue",c).attribute("aBandwidth",h).attribute("aCap",g).attribute("aCorner",u).attribute("aDefined",f),t.coordinate(0),t(e),a.coordinate(1),a(e),i(e),e.vertexShader().appendBody(`
            gl_Position.x += xModifier / uScreen.x * 2.0;
            gl_Position.y += yModifier / uScreen.y * 2.0;
        `),n(e),e(m)};return m.xValues=e=>(r.data(e),m),m.highValues=e=>(l.data(e),m),m.upperQuartileValues=e=>(d.data(e),m),m.medianValues=e=>(o.data(e),m),m.lowerQuartileValues=e=>(s.data(e),m),m.lowValues=e=>(c.data(e),m),m.bandwidth=e=>(h.data(e),m),m.capWidth=e=>(g.data(e),m),m.defined=e=>(f.data(e),m),m.xScale=(...e)=>e.length?(t=e[0],m):t,m.yScale=(...e)=>e.length?(a=e[0],m):a,m.decorate=(...e)=>e.length?(n=e[0],m):n,q(m,e,"context"),q(m,i,"lineWidth"),m},qt=()=>{const e=s.symbol(),t=Ae(),a=he("g","point"),n=e=>"translate("+e[0]+", "+e[1]+")",i=i=>{i.selection&&a.transition(i),i.each((i,r,l)=>{const d=i.filter(t.defined()),s=a(o.select(l[r]),d);s.enter().attr("transform",(e,a)=>n(t.values(e,a).origin)).attr("fill",Te.gray).attr("stroke",Te.black).append("path"),s.attr("transform",(e,a)=>n(t.values(e,a).origin)).select("path").attr("d",e),t.decorate()(s,i,r)})};return X(i,t,J("baseValue","bandwidth","align")),q(i,a,"key"),q(i,e,"type","size"),i},jt=()=>{const e=s.symbol(),t=Ae(),a=a=>{const n=a.filter(t.defined()),r=e.context();n.forEach((a,n)=>{r.save();const i=t.values(a,n);r.translate(i.origin[0],i.origin[1]),r.beginPath(),r.strokeStyle=Te.black,r.fillStyle=Te.gray,t.decorate()(r,a,n),e(a,n),r.fill(),r.stroke(),r.closePath(),r.restore()})};return X(a,t,J("baseValue","bandwidth","align")),q(a,e,"size","type","context"),a},Xt=()=>{let e=e=>e.high,t=e=>e.low,n=e=>e.cross,r="vertical",l="center",o=()=>5;const s=Ee({decorate:()=>{},defined:(a,r)=>L(t,e,n)(a,r),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return s.values=(a,d)=>{const i=o(a,d),c=ke(l,i),h=s.xScale(),g=s.yScale();if("vertical"===r){const r=g(e(a,d));return{origin:[h(n(a,d))+c,r],high:0,low:g(t(a,d))-r,width:i}}else{const r=h(t(a,d));return{origin:[r,g(n(a,d))+c],high:h(e(a,d))-r,low:0,width:i}}},s.xValues=()=>"vertical"===r?[n]:[e,t],s.yValues=()=>"vertical"===r?[e,t]:[n],s.orient=(...e)=>e.length?(r=e[0],s):r,s.lowValue=(...e)=>e.length?(t=Ve(e[0]),s):t,s.highValue=(...t)=>t.length?(e=Ve(t[0]),s):e,s.crossValue=(...e)=>e.length?(n=Ve(e[0]),s):n,s.bandwidth=(...e)=>e.length?(o=Ve(e[0]),s):o,s.align=(...e)=>e.length?(l=e[0],s):l,s},Kt=()=>{let e,t=e=>e.date,n=e=>e.open,r=e=>e.high,l=e=>e.low,o=e=>e.close,s=()=>5,c="center",h=(a,n)=>e.xScale()(t(a,n));return e=Ee({decorate:()=>{},defined:(e,a)=>L(t,n,l,r,o)(e,a),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()}),e.values=(t,a)=>{const i=o(t,a),d=n(t,a),g=s(t,a),u=ke(c,g);let f="";return i>d?f="up":i<d&&(f="down"),{cross:h(t,a)+u,open:e.yScale()(d),high:e.yScale()(r(t,a)),low:e.yScale()(l(t,a)),close:e.yScale()(i),width:g,direction:f}},e.xValues=()=>[t],e.yValues=()=>[n,r,l,o],e.crossValue=(...a)=>a.length?(t=a[0],e):t,e.openValue=(...t)=>t.length?(n=t[0],e):n,e.highValue=(...t)=>t.length?(r=t[0],e):r,e.lowValue=(...t)=>t.length?(l=t[0],e):l,e.yValue=e.closeValue=(...t)=>t.length?(o=t[0],e):o,e.bandwidth=(...t)=>t.length?(s=Ve(t[0]),e):s,e.align=(...t)=>t.length?(c=t[0],e):c,e},Jt=(e,t)=>{const a=Kt(),n=he("g",t),r=e=>"translate("+e.cross+", "+e.high+")",l=e=>t=>e.selection?t.transition(e):t,d=i=>{i.selection&&n.transition(i);const s=l(i);i.each((i,l,d)=>{const c=i.filter(a.defined()),h=n(o.select(d[l]),c);h.enter().attr("transform",(e,t)=>r(a.values(e,t))+" scale(1e-6, 1)").append("path"),h.each((n,l,i)=>{const d=a.values(n,l),c="up"===d.direction?Te.green:Te.red,h=s(o.select(i[l])).attr("class",t+" "+d.direction).attr("stroke",c).attr("fill",c).attr("transform",()=>r(d)+" scale(1)");e.x(0).width(d.width).open(()=>d.open-d.high).high(0).low(()=>d.low-d.high).close(()=>d.close-d.high),h.select("path").attr("d",e([n]))}),a.decorate()(h,i,l)})};return q(d,n,"key"),X(d,a),d},Zt=e=>{const t=Kt(),a=a=>{const n=a.filter(t.defined()),r=e.context();n.forEach((a,n)=>{r.save();const i=t.values(a,n);r.translate(i.cross,i.high),r.beginPath(),e.x(0).open(()=>i.open-i.high).width(i.width).high(0).low(()=>i.low-i.high).close(()=>i.close-i.high)([a]);const l="up"===i.direction?Te.green:Te.red;r.strokeStyle=l,r.fillStyle=l,t.decorate()(r,a,n),r.fill(),r.stroke(),r.closePath(),r.restore()})};return q(a,e,"context"),X(a,t),a},$t=e=>{const t=Kt();let a=()=>!1,n=[];const i=i=>{const r=We(t.xScale()),l=We(t.yScale());if(!Be(r.scale)||!Be(l.scale)||!a(n,i)){n=i;const a=new Float32Array(i.length),o=new Float32Array(i.length),s=new Float32Array(i.length),c=new Float32Array(i.length),h=new Float32Array(i.length),g=new Float32Array(i.length),u=new Float32Array(i.length);i.forEach((e,n)=>{a[n]=r.scale(t.crossValue()(e,n)),o[n]=l.scale(t.openValue()(e,n)),s[n]=l.scale(t.highValue()(e,n)),c[n]=l.scale(t.lowValue()(e,n)),h[n]=l.scale(t.closeValue()(e,n)),g[n]=t.bandwidth()(e,n),u[n]=t.defined()(e,n)}),e.xValues(a).openValues(o).highValues(s).lowValues(c).closeValues(h).bandwidth(g).defined(u)}e.xScale(r.glScale).yScale(l.glScale).decorate(e=>t.decorate()(e,i,0)),e(i.length)};return i.equals=(...e)=>e.length?(a=e[0],i):a,X(i,t,J("align")),q(i,e,"context","lineWidth"),i},ea=()=>{let e=e=>e.upperQuartile,t=e=>e.lowerQuartile,n=e=>e.high,r=e=>e.low,l=e=>e.value,o=e=>e.median,s="vertical",c="center",h=()=>5;const g=Ee({decorate:()=>{},defined:(a,d)=>L(r,n,t,e,l,o)(a,d),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return g.values=(a,d)=>{const i=h(a,d),u=ke(c,i),f=g.xScale(),p=g.yScale();if("vertical"===s){const s=p(n(a,d));return{origin:[f(l(a,d))+u,s],high:0,upperQuartile:p(e(a,d))-s,median:p(o(a,d))-s,lowerQuartile:p(t(a,d))-s,low:p(r(a,d))-s,width:i}}else{const s=f(r(a,d));return{origin:[s,p(l(a,d))+u],high:f(n(a,d))-s,upperQuartile:f(e(a,d))-s,median:f(o(a,d))-s,lowerQuartile:f(t(a,d))-s,low:0,width:i}}},g.xValues=()=>"vertical"===s?[l]:[e,t,n,r,o],g.yValues=()=>"vertical"===s?[e,t,n,r,o]:[l],g.orient=(...e)=>e.length?(s=e[0],g):s,g.lowerQuartileValue=(...e)=>e.length?(t=Ve(e[0]),g):t,g.upperQuartileValue=(...t)=>t.length?(e=Ve(t[0]),g):e,g.lowValue=(...e)=>e.length?(r=Ve(e[0]),g):r,g.highValue=(...e)=>e.length?(n=Ve(e[0]),g):n,g.crossValue=(...e)=>e.length?(l=Ve(e[0]),g):l,g.medianValue=(...e)=>e.length?(o=Ve(e[0]),g):o,g.bandwidth=(...e)=>e.length?(h=Ve(e[0]),g):h,g.align=(...e)=>e.length?(c=e[0],g):c,g},ta=()=>{let e=[],t=e=>e,n=(e,t)=>t;const i=Ee({decorate:()=>{},xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return i.xValues=()=>e.map(e=>e.xValues()).reduce((e,t)=>e.concat(t)),i.yValues=()=>e.map(e=>e.yValues()).reduce((e,t)=>e.concat(t)),i.mapping=(...e)=>e.length?(t=e[0],i):t,i.key=(...e)=>e.length?(n=e[0],i):n,i.series=(...t)=>t.length?(e=t[0],i):e,i},aa=()=>{const e=ta(),t=he("g"),a=he("g","multi"),n=n=>{n.selection&&(a.transition(n),t.transition(n));const i=e.mapping(),r=e.series(),l=e.xScale(),d=e.yScale();n.each((n,s,c)=>{const h=a(o.select(c[s]),r);h.each((e,a,s)=>{e.xScale(l).yScale(d);const c=i(n,a,r),h=t(o.select(s[a]),[c]);h.call(e)});const g=h.selection?h.selection():h;g.order(),e.decorate()(h,n,s)})};return X(n,e),q(n,a,"key"),n},na=()=>{let e=null;const t=ta(),a=a=>{const n=t.mapping(),i=t.series(),r=t.xScale(),l=t.yScale();i.forEach((d,o)=>{const s=n(a,o,i);d.context(e).xScale(r).yScale(l);let h;d.decorate?(h=d.decorate(),d.decorate((e,n,r)=>{t.decorate()(e,a,o),h(e,n,r)})):t.decorate()(e,a,o),d(s),h&&d.decorate(h)})};return a.context=(...t)=>t.length?(e=t[0],a):e,X(a,t),a},ia=()=>{let e=()=>50,n="center";const r=a.scaleBand(),l=Ee({decorate:()=>{},xScale:a.scaleLinear(),yScale:a.scaleLinear()});return l.offsetScaleForDatum=(a,l,d)=>{const i=e(l,d),o=ke(n,i),s=i/2;return r.domain(t.range(0,a.length)).range([-s+o,s+o])},l.bandwidth=(...t)=>t.length?(e=Ve(t[0]),l):e,l.align=(...e)=>e.length?(n=e[0],l):n,X(l,r,$({paddingInner:"paddingOuter"})),l},ra=()=>{let e="vertical",t=_e();const a=na(),n=n=>{"vertical"===e?a.series(n[0].map(()=>t)).mapping((e,t)=>e.map(e=>e[t])):a.series(n.map(()=>t)).mapping((e,t)=>e[t]),a(n)};return n.series=(...e)=>e.length?(t=e[0],n):t,n.orient=(...t)=>t.length?(e=t[0],n):e,X(n,a,J("series","mapping")),n};const la=e=>e.sort(t.ascending).filter((e,t,a)=>-1===a.indexOf(e,t+1));var da=()=>{let e=e=>e.x,n=e=>e.y,r=e=>e.color,l=()=>5,o=()=>5,s=a.interpolateViridis;const c=Ee({decorate:()=>{},defined:(t,a)=>L(e,n,r)(t,a),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return c.pathGenerator=re().x(0).y(0),c.colorScale=e=>{const n=e.map(r);return a.scaleLinear().domain([t.min(n),t.max(n)])},c.values=(t,a)=>({x:c.xScale()(e(t,a)),y:c.yScale()(n(t,a)),colorValue:r(t,a),width:o(t,a),height:l(t,a)}),c.xValues=()=>[e],c.yValues=()=>[n],c.xValue=(...t)=>t.length?(e=Ve(t[0]),c):e,c.yValue=(...e)=>e.length?(n=Ve(e[0]),c):n,c.colorValue=(...e)=>e.length?(r=Ve(e[0]),c):r,c.colorInterpolate=(...e)=>e.length?(s=e[0],c):s,c.xBandwidth=(...e)=>e.length?(o=Ve(e[0]),c):o,c.yBandwidth=(...e)=>e.length?(l=Ve(e[0]),c):l,X(c,c.pathGenerator,$({horizontalAlign:"xAlign",verticalAlign:"yAlign"})),c},oa=e=>"function"==typeof e?e:()=>e,sa=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n=e=>e,i=n,r=()=>{},l="horizontal";const d=he("g","annotation-line"),s=a=>{if(a.selection&&d.transition(a),"horizontal"!==l&&"vertical"!==l)throw new Error("Invalid orientation");const s="horizontal"===l,c=s?(e,t)=>`translate(${e}, ${t})`:(e,t)=>`translate(${t}, ${e})`,h=s?"x2":"y2",g=s?e:t,u=s?t:e,f=s?"left-handle":"bottom-handle",p=s?"right-handle":"top-handle",m=s?"9":"0",y=s?"0":"9",x=s?"0.32em":"0.71em",b=s?"start":"middle",v=g.range(),S=(...e)=>c(v[0],u(n(...e))),w=v[1]-v[0];a.each((e,t,a)=>{const n=d(o.select(a[t]),e),s=n.enter().attr("transform",S).style("stroke","#bbb");s.append("line").attr(h,w),s.append("g").classed(f,!0).style("stroke","none"),s.append("g").classed(p,!0).style("stroke","none").attr("transform",c(w,0)).append("text").attr("text-anchor",b).attr("x",m).attr("y",y).attr("dy",x),n.attr("class",`annotation-line ${l}`),n.attr("transform",S),n.select("line").attr(h,w),n.select("g."+p).attr("transform",c(w,0)),n.select("text").text(i),r(n,e,t)})};return s.xScale=(...t)=>t.length?(e=t[0],s):e,s.yScale=(...e)=>e.length?(t=e[0],s):t,s.value=(...e)=>e.length?(n=oa(e[0]),s):n,s.label=(...e)=>e.length?(i=oa(e[0]),s):i,s.decorate=(...e)=>e.length?(r=e[0],s):r,s.orient=(...e)=>e.length?(l=e[0],s):l,s},ca=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n=e=>e,r=n,l=()=>{},d="horizontal";const o=s.line(),c=a=>{if("horizontal"!==d&&"vertical"!==d)throw new Error("Invalid orientation");const s="horizontal"===d,c=o.context(),h=s?e:t,g=s?t:e,u=h.domain(),f=s?9:0,p=s?0:9,m=s?"left":"center",b=s?"middle":"hanging";a.forEach((e,t)=>{c.save(),c.beginPath(),c.strokeStyle="#bbb",c.fillStyle="#000",c.textAlign=m,c.textBaseline=b,l(c,e,t),o.context(c)(u.map(t=>{const a=[h(t),g(n(e))];return s?a:a.reverse()}));const a=s?h(u[1]):g(n(e)),i=s?g(n(e)):h(u[1]);c.fillText(r(e),a+f,i+p),c.fill(),c.stroke(),c.closePath(),c.restore()})};return c.xScale=(...t)=>t.length?(e=t[0],c):e,c.yScale=(...e)=>e.length?(t=e[0],c):t,c.value=(...e)=>e.length?(n=oa(e[0]),c):n,c.label=(...e)=>e.length?(r=oa(e[0]),c):r,c.decorate=(...e)=>e.length?(l=e[0],c):l,c.orient=(...e)=>e.length?(d=e[0],c):d,q(c,o,"context"),c},ha=()=>{let e=a.scaleIdentity(),t=[10],n=null;const i=()=>null==n?e.ticks?e.ticks(...t):e.domain():n;return i.scale=(...t)=>t.length?(e=t[0],i):e,i.ticks=(...e)=>(t=e,i),i.tickArguments=(...e)=>e.length?(t=e[0],i):t,i.tickValues=(...e)=>e.length?(n=e[0],i):n,i};const ga=e=>e;const ua=e=>e,fa=(e,t,a={})=>{let n=[10],i=null,r=()=>{},l=null,d=6,c=6,h=3;const u=s.line(),f=he("g","tick").key(ua),p=he("path","domain"),m=()=>({offset:[0,c+h]}),y=()=>({path:[[0,0],[0,c]]}),x=a.labelOffset||m,b=a.tickPath||y,v=(e,t)=>{let a=0;return e.bandwidth&&(a=e.bandwidth()/2,e.round()&&(a=z(a))),n=>t(e(n)+a,0)},S=(e,t)=>V()?`translate(${t}, ${e})`:`translate(${e}, ${t})`,w=e=>V()?e.map(e=>[e[1],e[0]]):e,V=()=>"left"===e||"right"===e,k=(e,a,n)=>t[e]?t[e].apply(t,a):n,E=a=>{a.selection&&(f.transition(a),p.transition(a)),a.each((a,s,c)=>{const h=c[s],m=o.select(h);h.__scale__||m.attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","right"===e?"start":"left"===e?"end":"middle");const y=h.__scale__||t;h.__scale__=t.copy();const E=null==i?k("ticks",n,t.domain()):i,A=null==l?k("tickFormat",n,ua):l,T="bottom"===e||"right"===e?1:-1,I=([e,t])=>[e,T*t],_=t.range(),B=w([[_[0],T*d],[_[0],0],[_[1],0],[_[1],T*d]]),P=p(m,[a]);P.attr("d",u(B)).attr("stroke","#000");const C=f(m,E),g=E.map((e,t)=>x(e,t,E)),N=E.map((e,t)=>b(e,t,E));C.enter().attr("transform",v(y,S)).append("path").attr("stroke","#000"),C.enter().append("text").attr("transform",(e,t)=>S(...I(g[t].offset))).attr("fill","#000"),C.exit().attr("transform",v(t,S)),C.select("path").attr("visibility",(e,t)=>N[t].hidden&&"hidden").attr("d",(e,t)=>u(w(N[t].path.map(I)))),C.select("text").attr("visibility",(e,t)=>g[t].hidden&&"hidden").attr("transform",(e,t)=>S(...I(g[t].offset))).attr("dy",()=>{let t="0em";return V()?t="0.32em":"bottom"===e&&(t="0.71em"),t}).text(A),C.attr("transform",v(t,S)),r(C,a,s)})};return E.tickFormat=(...e)=>e.length?(l=e[0],E):l,E.tickSize=(...e)=>e.length?(c=d=+e[0],E):c,E.tickSizeInner=(...e)=>e.length?(c=+e[0],E):c,E.tickSizeOuter=(...e)=>e.length?(d=+e[0],E):d,E.tickPadding=(...e)=>e.length?(h=e[0],E):h,E.decorate=(...e)=>e.length?(r=e[0],E):r,E.scale=(...e)=>e.length?(t=e[0],E):t,E.ticks=(...e)=>(n=[...e],E),E.tickArguments=(...e)=>e.length?(n=null==e[0]?[]:[...e[0]],E):n.slice(),E.tickValues=(...e)=>e.length?(i=null==e[0]?[]:[...e[0]],E):i.slice(),E.orient=()=>e,E},pa=(e,t)=>{let a=!1;const n=(e,n,r)=>{let l=0,d=i.tickSizeInner()+i.tickPadding(),o=!1;if(a){const a=t(e),s=n<r.length-1?t(r[n+1]):t.range()[1];l=(s-a)/2,d=i.tickPadding(),o=n===r.length-1&&a===s}return{offset:[l,d],hidden:o}},i=fa(e,t,{labelOffset:n}),r=e=>i(e);return r.tickCenterLabel=(...e)=>e.length?(a=e[0],r):a,X(r,i),r},ma=e=>pa("top",e),ya=e=>pa("bottom",e),xa=e=>pa("left",e),ba=e=>pa("right",e),va=(e,t)=>{let a=null;const n=(e,a,n)=>{if(t.step)return t.step();const i=t(e);return a<n.length-1?t(n[a+1])/i:2*(t.range()[1]-i)},i=(e,t,i)=>{let l=0;return l=a?a(e,t):n(e,t,i)/2,{path:[[l,0],[l,r.tickSizeInner()]],hidden:t===i.length-1}},r=fa(e,t,{labelOffset:()=>({offset:[0,r.tickPadding()]}),tickPath:i}),l=e=>{r(e)};return l.tickOffset=(...e)=>e.length?(a=e[0],l):a,X(l,r),l};var Sa=e=>{return t=>{const a=e.ticks?e.ticks():e.domain(),n=t.append("text"),i=a.map(e=>n.text(e).node().getBBox()),r=M(...i.map(e=>e.height)),l=M(...i.map(e=>e.width));return n.remove(),{maxHeight:r,maxWidth:l,labelCount:a.length}}};const wa="__d3fc-elements__",Va=e=>e[wa]||{},ka=(e,t)=>void(e[wa]=t),Ea=e=>delete e[wa],Aa=e=>"D3FC-GROUP"===e.tagName?[e,...e.querySelectorAll("d3fc-canvas, d3fc-group, d3fc-svg")]:[e],Ta=e=>{const{width:t,height:a}=Va(e),n=e.useDevicePixelRatio&&null!=window.devicePixelRatio?window.devicePixelRatio:1,i=e.clientWidth*n,r=e.clientHeight*n;ka(e,{pixelRatio:n,width:i,height:r,resized:i!==t||r!==a})};if("function"!=typeof CustomEvent)throw new Error("d3fc-element depends on CustomEvent. Make sure that you load a polyfill in older browsers. See README.");const Ia=e=>{const t=Va(e),a=new CustomEvent("measure",{detail:t});e.dispatchEvent(a)},_a=e=>{const t=Va(e),a=new CustomEvent("draw",{detail:t});e.dispatchEvent(a)};var Ba=e=>{const t=e.map(Aa).reduce((e,t)=>e.concat(t));t.forEach(Ta),t.forEach(Ia),t.forEach(_a)};const Pa=e=>Va(e.ownerDocument).queue||[],Ca=(e,t)=>{let{requestId:a}=Va(e.ownerDocument);null==a&&(a=requestAnimationFrame(()=>{const t=Pa(e);Ba(t),Na(e)})),ka(e.ownerDocument,{queue:t,requestId:a})},Na=e=>Ea(e.ownerDocument),Ra=(e,t)=>{let a=e;do if(a.parentNode===t)return!0;while(a=a.parentNode);return!1};var Da=e=>{const t=Pa(e),a=-1<t.indexOf(e);if(!a){const a=t.some(t=>Ra(e,t));if(!a){const a=t.filter(t=>!Ra(t,e));a.push(e),Ca(e,a)}}};if("function"!=typeof HTMLElement)throw new Error("d3fc-element depends on Custom Elements (v1). Make sure that you load a polyfill in older browsers. See README.");const La=e=>{null!=e.__measureListener__||(e.__measureListener__=t=>e.setMeasurements(t.detail),e.addEventListener("measure",e.__measureListener__))},za=e=>{null==e.__measureListener__||(e.removeEventListener("measure",e.__measureListener__),e.__measureListener__=null)};var Oa=(e,t)=>class extends HTMLElement{static get observedAttributes(){return["use-device-pixel-ratio"]}attributeChangedCallback(e){"use-device-pixel-ratio"===e?this.requestRedraw():void 0}connectedCallback(){0===this.childNodes.length&&this.appendChild(e()),La(this)}disconnectedCallback(){za(this)}setMeasurements({width:e,height:a}){const{childNodes:[n,...i]}=this;if(0<i.length)throw new Error("A d3fc-svg/canvas element must only contain a single svg/canvas element.");t(this,n,{width:e,height:a})}get useDevicePixelRatio(){return this.hasAttribute("use-device-pixel-ratio")&&"false"!==this.getAttribute("use-device-pixel-ratio")}set useDevicePixelRatio(e){e&&!this.useDevicePixelRatio?this.setAttribute("use-device-pixel-ratio",""):!e&&this.useDevicePixelRatio&&this.removeAttribute("use-device-pixel-ratio"),this.requestRedraw()}requestRedraw(){Da(this)}};class Ha extends Oa(()=>document.createElement("canvas"),(e,t,{width:a,height:n})=>{if(t.setAttribute("width",a),t.setAttribute("height",n),e.setWebglViewport){const e=t.getContext("webgl");e.viewport(0,0,a,n)}}){get setWebglViewport(){return this.hasAttribute("set-webgl-viewport")&&"false"!==this.getAttribute("set-webgl-viewport")}set setWebglViewport(e){e&&!this.setWebglViewport?this.setAttribute("set-webgl-viewport",""):!e&&this.setWebglViewport&&this.removeAttribute("set-webgl-viewport"),this.requestRedraw()}}const Ga=e=>{e.autoResize?Ua(e):Ma(e)},Ua=e=>{null!=e.__autoResizeListener__||(e.__autoResizeListener__=()=>Da(e),addEventListener("resize",e.__autoResizeListener__))},Ma=e=>{null==e.__autoResizeListener__||(removeEventListener("resize",e.__autoResizeListener__),e.__autoResizeListener__=null)};class Fa extends HTMLElement{connectedCallback(){Ga(this)}disconnectedCallback(){Ma(this)}requestRedraw(){Da(this)}get autoResize(){return this.hasAttribute("auto-resize")&&"false"!==this.getAttribute("auto-resize")}set autoResize(e){e&&!this.autoResize?this.setAttribute("auto-resize",""):!e&&this.autoResize&&this.removeAttribute("auto-resize"),Ga(this)}static get observedAttributes(){return["auto-resize"]}attributeChangedCallback(e){"auto-resize"===e?Ga(this):void 0}}var Wa=Oa(()=>document.createElementNS("http://www.w3.org/2000/svg","svg"),(e,t,{width:a,height:n})=>{t.setAttribute("viewBox",`0 0 ${a} ${n}`)});const Ya=document.createElement("style");if(Ya.setAttribute("type","text/css"),document.querySelector("head").appendChild(Ya),Ya.styleSheet?Ya.styleSheet.cssText+="d3fc-canvas,d3fc-svg{position:relative;display:block}d3fc-canvas>canvas,d3fc-svg>svg{position:absolute;height:100%;width:100%}d3fc-svg>svg{overflow:visible}":Ya.textContent+="d3fc-canvas,d3fc-svg{position:relative;display:block}d3fc-canvas>canvas,d3fc-svg>svg{position:absolute;height:100%;width:100%}d3fc-svg>svg{overflow:visible}","object"!=typeof customElements||"function"!=typeof customElements.define)throw new Error("d3fc-element depends on Custom Elements (v1). Make sure that you load a polyfill in older browsers. See README.");customElements.define("d3fc-canvas",Ha),customElements.define("d3fc-group",Fa),customElements.define("d3fc-svg",Wa);var Qa=(...e)=>{const t={},a=e=>{for(const a of Object.keys(t))e[a].apply(null,t[a]);return e};for(const n of e)a[n]=(...e)=>e.length?(t[n]=e,a):t[n];return a};const qa=document.createElement("style");qa.setAttribute("type","text/css"),document.querySelector("head").appendChild(qa),qa.styleSheet?qa.styleSheet.cssText+="d3fc-group.cartesian-chart{width:100%;height:100%;overflow:hidden;display:grid;display:-ms-grid;grid-template-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);grid-template-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);}\nd3fc-group.cartesian-chart>.top-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:1;-ms-grid-row:1;}\nd3fc-group.cartesian-chart>.top-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:2;-ms-grid-row:2;}\nd3fc-group.cartesian-chart>.left-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:1;-ms-grid-column:1;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.left-axis{width:3em;grid-column:2;-ms-grid-column:2;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.plot-area{overflow:hidden;grid-column:3;-ms-grid-column:3;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-axis{width:3em;grid-column:4;-ms-grid-column:4;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:5;-ms-grid-column:5;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.bottom-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:4;-ms-grid-row:4;}\nd3fc-group.cartesian-chart>.bottom-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:5;-ms-grid-row:5;}\nd3fc-group.cartesian-chart>.y-label{display:flex;transform:rotate(-90deg);width:1em;white-space:nowrap;justify-content:center;}":qa.textContent+="d3fc-group.cartesian-chart{width:100%;height:100%;overflow:hidden;display:grid;display:-ms-grid;grid-template-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);grid-template-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);}\nd3fc-group.cartesian-chart>.top-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:1;-ms-grid-row:1;}\nd3fc-group.cartesian-chart>.top-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:2;-ms-grid-row:2;}\nd3fc-group.cartesian-chart>.left-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:1;-ms-grid-column:1;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.left-axis{width:3em;grid-column:2;-ms-grid-column:2;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.plot-area{overflow:hidden;grid-column:3;-ms-grid-column:3;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-axis{width:3em;grid-column:4;-ms-grid-column:4;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:5;-ms-grid-column:5;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.bottom-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:4;-ms-grid-row:4;}\nd3fc-group.cartesian-chart>.bottom-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:5;-ms-grid-row:5;}\nd3fc-group.cartesian-chart>.y-label{display:flex;transform:rotate(-90deg);width:1em;white-space:nowrap;justify-content:center;}";const ja=e=>"function"==typeof e?e:()=>e;var Xa=(...e)=>{const{xScale:t,yScale:a,xAxis:n,yAxis:r}=Ka(...e);let l=ja(""),d=ja(""),s=ja(""),c=ja(null),h=ja(null),g=ja("right"),u=ja("bottom"),f=null,p=null,m=null,y=Qa("tickFormat","ticks","tickArguments","tickSize","tickSizeInner","tickSizeOuter","tickValues","tickPadding","tickCenterLabel"),x=()=>{},b=Qa("tickFormat","ticks","tickArguments","tickSize","tickSizeInner","tickSizeOuter","tickValues","tickPadding","tickCenterLabel"),v=()=>{},S=()=>{};const w=he("d3fc-group","cartesian-chart"),V=he("d3fc-canvas","gl-plot-area"),k=he("d3fc-canvas","canvas-plot-area"),E=he("d3fc-svg","plot-area"),A=he("d3fc-svg","x-axis").key(e=>e),T=he("d3fc-svg","y-axis").key(e=>e),I=he("div","chart-label"),_=he("div","x-label").key(e=>e),B=he("div","y-label").key(e=>e),P=e=>t=>e.selection?t.transition(e):t,C=e=>{const C=P(e);e.each((e,i,P)=>{const N=w(o.select(P[i]),[e]);N.enter().attr("auto-resize",""),I(N,[u(e)]).attr("class",e=>"top"===e?"chart-label bottom-label":"chart-label top-label").style("margin-bottom",e=>"top"===e?0:"1em").style("margin-top",e=>"top"===e?"1em":0).text(l(e)),_(N,[u(e)]).attr("class",e=>`x-label ${e}-label`).text(d(e)),B(N,[g(e)]).attr("class",e=>`y-label ${e}-label`).text(s(e)),V(N,f?[e]:[]).attr("set-webgl-viewport","").classed("plot-area",!0).on("draw",(e,n,i)=>{const r=o.select(i[n]).select("canvas").node();f.context(r.getContext("webgl")).xScale(t).yScale(a),f(e)}),k(N,p?[e]:[]).classed("plot-area",!0).on("draw",(e,n,i)=>{const r=o.select(i[n]).select("canvas").node();p.context(r.getContext("2d")).xScale(t).yScale(a),p(e)}),E(N,m?[e]:[]).on("draw",(e,n,i)=>{m.xScale(t).yScale(a),C(o.select(i[n])).select("svg").call(m)}),A(N,[u(e)]).attr("class",e=>`x-axis ${e}-axis`).style("height",c(e)).on("measure",(e,a,n)=>{const{width:i,height:r}=o.event.detail;"top"===e&&o.select(n[a]).select("svg").attr("viewBox",`0 ${-r} ${i} ${r}`),t.range([0,i])}).on("draw",(e,a,i)=>{const r="top"===e?n.top(t):n.bottom(t);r.decorate(x),C(o.select(i[a])).select("svg").call(y(r))}),T(N,[g(e)]).attr("class",e=>`y-axis ${e}-axis`).style("width",h(e)).on("measure",(e,t,n)=>{const{width:i,height:r}=o.event.detail;"left"===e&&o.select(n[t]).select("svg").attr("viewBox",`${-i} 0 ${i} ${r}`),a.range([r,0])}).on("draw",(e,t,n)=>{const i="left"===e?r.left(a):r.right(a);i.decorate(v),C(o.select(n[t])).select("svg").call(b(i))}),N.each((e,t,a)=>a[t].requestRedraw()),S(N,e,i)})},N=J(/range\w*/,/tickFormat/);return X(C,t,N,te("x")),X(C,a,N,te("y")),X(C,y,te("x")),X(C,b,te("y")),C.xOrient=(...e)=>e.length?(u=ja(e[0]),C):u,C.yOrient=(...e)=>e.length?(g=ja(e[0]),C):g,C.xDecorate=(...e)=>e.length?(x=e[0],C):x,C.yDecorate=(...e)=>e.length?(v=e[0],C):v,C.chartLabel=(...e)=>e.length?(l=ja(e[0]),C):l,C.xLabel=(...e)=>e.length?(d=ja(e[0]),C):d,C.yLabel=(...e)=>e.length?(s=ja(e[0]),C):s,C.xAxisHeight=(...e)=>e.length?(c=ja(e[0]),C):c,C.yAxisWidth=(...e)=>e.length?(h=ja(e[0]),C):h,C.webglPlotArea=(...e)=>e.length?(f=e[0],C):f,C.canvasPlotArea=(...e)=>e.length?(p=e[0],C):p,C.svgPlotArea=(...e)=>e.length?(m=e[0],C):m,C.decorate=(...e)=>e.length?(S=e[0],C):S,C};const Ka=(...e)=>{const t={xScale:a.scaleIdentity(),yScale:a.scaleIdentity(),xAxis:{bottom:ya,top:ma},yAxis:{right:ba,left:xa}};return 1!==e.length||e[0].domain||e[0].range?Object.assign(t,{xScale:e[0]||t.xScale,yScale:e[1]||t.yScale}):Object.assign(t,e[0])},Ja=e=>"function"==typeof e?e:()=>e;var Za=(e,t)=>(...a)=>{let n=Ja(""),i=t,r=()=>{};const l=Xa(...a),d=t=>{e(l,i),l.decorate((e,t,a)=>{e.enter().select(".x-label").style("height","1em").style("line-height","1em");const i=l.yOrient()(t);e.enter().append("div").attr("class","y-label-container").style("grid-column","left"===i?1:5).style("-ms-grid-column","left"===i?1:5).style("grid-row",3).style("-ms-grid-row",3).style("width","1em").style("display","flex").style("align-items","center").style("justify-content","center").style("white-space","nowrap").append("div").attr("class","y-label").style("transform","rotate(-90deg)"),e.select(".y-label-container>.y-label").text(n),r(e,t,a)}),t.call(l)};return X(d,l,Z(/^x/,/^y/,"chartLabel")),d.yLabel=(...e)=>e.length?(n=Ja(e[0]),d):n,d.plotArea=(...e)=>e.length?(i=e[0],d):i,d.decorate=(...e)=>e.length?(r=e[0],d):r,d},$a=Za((e,t)=>e.svgPlotArea(t),Ie),en=Za((e,t)=>e.canvasPlotArea(t),_e);const tn=e=>"x"===e?h.brushX():"y"===e?h.brushY():"xy"===e?h.brush():void 0,an=e=>[e[1],e[0]],nn=e=>{const t=tn(e),n=c.dispatch("brush","start","end");let i=a.scaleIdentity(),r=a.scaleIdentity();const l=he("g","brush"),d=(t,a,n)=>"x"===e?t.map(a):"y"===e?t.map(n):"xy"===e?[[a(t[0][0]),n(t[0][1])],[a(t[1][0]),n(t[1][1])]]:void 0,s=e=>d(e,a.scaleLinear().domain(i.range()).invert,a.scaleLinear().domain(an(r.range())).invert),h=e=>d(e,a.scaleLinear().domain(i.range()),a.scaleLinear().domain(an(r.range()))),g=t=>{const n=a.scaleLinear().domain(i.domain());return"x"===e?t.map(n.invert):"xy"===e?[n.invert(t[0][0]),n.invert(t[1][0])]:void 0},u=t=>{const n=a.scaleLinear().domain(an(r.domain()));return"y"===e?[t[1],t[0]].map(n.invert):"xy"===e?[n.invert(t[1][1]),n.invert(t[0][1])]:void 0},f=e=>{if(!(e.sourceEvent&&"draw"===e.sourceEvent.type))if(e.selection){const t=h(e.selection);n.call(e.type,{},{selection:t,xDomain:g(t),yDomain:u(t)})}else n.call(e.type,{},{})},p=e=>{e.each((e,a,n)=>{t.extent([[i.range()[0],r.range()[1]],[i.range()[1],r.range()[0]]]),t.on("end",()=>f(o.event)).on("brush",()=>f(o.event)).on("start",()=>f(o.event));const d=l(o.select(n[a]),[e]);d.call(t).call(t.move,e?s(e):null)})};return p.xScale=(...e)=>e.length?(i=e[0],p):i,p.yScale=(...e)=>e.length?(r=e[0],p):r,q(p,n,"on"),q(p,t,"filter","handleSize"),p};e.annotationCanvasBand=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n="horizontal",r=e=>e.from,l=e=>e.to,o=()=>{};const s=re().horizontalAlign("right").verticalAlign("top");var c=a=>{if("horizontal"!==n&&"vertical"!==n)throw new Error("Invalid orientation");const c=s.context(),h="horizontal"===n,g=h?e:t,u=h?t:e,f=g.range(),p=f[1]-f[0],m=h?"x":"y",y=h?"y":"x",x=h?"height":"width",b=h?"width":"height";a.forEach((e,t)=>{c.save(),c.beginPath(),c.strokeStyle="transparent",s[y](u(r(e))),s[m](f[0]),s[b](p),s[x](u(l(e))-u(r(e))),o(c,e,t),s.context(c)([e],t),c.fill(),c.stroke(),c.closePath(),c.restore()})};return c.xScale=(...t)=>t.length?(e=t[0],c):e,c.yScale=(...e)=>e.length?(t=e[0],c):t,c.orient=(...e)=>e.length?(n=e[0],c):n,c.decorate=(...e)=>e.length?(o=e[0],c):o,c.fromValue=(...e)=>e.length?(r=oa(e[0]),c):r,c.toValue=(...e)=>e.length?(l=oa(e[0]),c):l,q(c,s,"context"),c},e.annotationCanvasCrosshair=()=>{let e=e=>e.x,t=e=>e.y,n=a.scaleIdentity(),i=a.scaleIdentity();const r=jt(),l=ca(),o=ca().orient("vertical"),s=a.scaleIdentity(),c=a.scaleIdentity(),h=na().series([l,o,r]).xScale(s).yScale(c).mapping(e=>[e]),g=a=>{a.forEach(a=>{s.range(n.range()),c.range(i.range()),r.crossValue(e).mainValue(t),l.value(t),o.value(e),h(a)})};g.x=(...t)=>t.length?(e=t[0],g):e,g.y=(...e)=>e.length?(t=e[0],g):t,g.xScale=(...e)=>e.length?(n=e[0],g):n,g.yScale=(...e)=>e.length?(i=e[0],g):i;const u=Z("label","decorate");return X(g,l,u,te("y")),X(g,o,u,te("x")),q(g,r,"decorate"),q(g,h,"context"),g},e.annotationCanvasGridline=()=>{let e=()=>{},t=()=>{};const a=ha(),n=ha(),r=s.line(),l=()=>{const l=r.context(),o=a.scale(),s=n.scale();a().forEach((t,a)=>{l.save(),l.beginPath(),l.strokeStyle="#bbb",l.fillStyle="transparent",e(l,t,a),r.context(l)(s.domain().map(e=>[o(t),s(e)])),l.fill(),l.stroke(),l.closePath(),l.restore()}),n().forEach((e,a)=>{l.save(),l.beginPath(),l.strokeStyle="#bbb",l.fillStyle="transparent",t(l,e,a),r.context(l)(o.domain().map(t=>[o(t),s(e)])),l.fill(),l.stroke(),l.closePath(),l.restore()})};return l.yDecorate=(...e)=>e.length?(t=e[0],l):t,l.xDecorate=(...t)=>t.length?(e=t[0],l):e,X(l,a,te("x")),X(l,n,te("y")),q(l,r,"context"),l},e.annotationCanvasLine=ca,e.annotationSvgBand=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n="horizontal",i=e=>e.from,r=e=>e.to,l=()=>{};const d=he("g","annotation-band"),s=re().horizontalAlign("center").verticalAlign("center").x(0).y(0);var c=a=>{if(a.selection&&d.transition(a),"horizontal"!==n&&"vertical"!==n)throw new Error("Invalid orientation");const c="horizontal"===n,h=c?(e,t)=>`translate(${e}, ${t})`:(e,t)=>`translate(${t}, ${e})`,g=c?e:t,u=c?t:e,f=g.range(),p=f[1]-f[0],m=c?"height":"width",y=c?"width":"height",x=(...e)=>h((f[1]+f[0])/2,(u(r(...e))+u(i(...e)))/2);s[y](p),s[m]((...e)=>u(r(...e))-u(i(...e))),a.each((e,t,a)=>{var i=d(o.select(a[t]),e);i.enter().attr("transform",x).append("path").classed("band",!0),i.attr("class",`annotation-band ${n}`).attr("transform",x).select("path").attr("d",(e,t)=>s([e],t)),l(i,e,t)})};return c.xScale=(...t)=>t.length?(e=t[0],c):e,c.yScale=(...e)=>e.length?(t=e[0],c):t,c.orient=(...e)=>e.length?(n=e[0],c):n,c.decorate=(...e)=>e.length?(l=e[0],c):l,c.fromValue=(...e)=>e.length?(i=oa(e[0]),c):i,c.toValue=(...e)=>e.length?(r=oa(e[0]),c):r,c},e.annotationSvgCrosshair=function(){let e=e=>e.x,t=e=>e.y,n=a.scaleIdentity(),i=a.scaleIdentity(),r=()=>{};const l=he("g","annotation-crosshair"),d=qt(),s=sa(),c=sa().orient("vertical"),h=a.scaleIdentity(),u=a.scaleIdentity(),f=aa().series([s,c,d]).xScale(h).yScale(u).mapping(e=>[e]),p=a=>{a.selection&&l.transition(a),a.each((a,p,m)=>{const y=l(o.select(m[p]),a);y.enter().style("pointer-events","none"),h.range(n.range()),u.range(i.range()),d.crossValue(e).mainValue(t),s.value(t),c.value(e),y.call(f),r(y,a,p)})};p.x=(...t)=>t.length?(e=t[0],p):e,p.y=(...e)=>e.length?(t=e[0],p):t,p.xScale=(...e)=>e.length?(n=e[0],p):n,p.yScale=(...e)=>e.length?(i=e[0],p):i,p.decorate=(...e)=>e.length?(r=e[0],p):r;const m=Z("label");return X(p,s,m,te("y")),X(p,c,m,te("x")),p},e.annotationSvgGridline=()=>{let e=()=>{},t=()=>{};const a=ha(),n=ha(),i=he("line","gridline-y").key(ga),r=he("line","gridline-x").key(ga),l=l=>{l.selection&&(i.transition(l),r.transition(l)),l.each((l,d,s)=>{const c=s[d],h=o.select(s[d]),g=a.scale(),u=n.scale(),f=c.__x_scale__||g;c.__x_scale__=g.copy();const p=a(),m=i(h,p);m.enter().attr("x1",f).attr("x2",f).attr("y1",u.range()[0]).attr("y2",u.range()[1]),m.attr("x1",g).attr("x2",g).attr("y1",u.range()[0]).attr("y2",u.range()[1]).attr("stroke","#bbb"),m.exit().attr("x1",g).attr("x2",g),e(m,p,d);const y=c.__y_scale__||u;c.__y_scale__=u.copy();const x=n(),b=r(h,x);b.enter().attr("y1",y).attr("y2",y).attr("x1",g.range()[0]).attr("x2",g.range()[1]),b.attr("y1",u).attr("y2",u).attr("x1",g.range()[0]).attr("x2",g.range()[1]).attr("stroke","#bbb"),b.exit().attr("y1",u).attr("y2",u),t(b,x,d)})};return l.yDecorate=(...e)=>e.length?(t=e[0],l):t,l.xDecorate=(...t)=>t.length?(e=t[0],l):e,X(l,i,$({key:"xKey"})),X(l,r,$({key:"yKey"})),X(l,a,te("x")),X(l,n,te("y")),l},e.annotationSvgLine=sa,e.autoBandwidth=e=>{let a=.75;const n=e=>{if(1>=e.length)return 10;e=la(e);const n=t.pairs(e).map(e=>F(e[0]-e[1])),i=t.min(n);return a*i},i=(t,a,i)=>{if(t.bandwidth)return t.bandwidth();else{const r=Array.isArray(a)?[].concat(...a):a,l=r.filter(e.defined()).map(i()).map(t),d=n(l);return d}},r=t=>{const a=t=>{if(e.xBandwidth&&e.yBandwidth)e.xBandwidth(i(e.xScale(),t,e.xValue)),e.yBandwidth(i(e.yScale(),t,e.yValue));else{const a=e.orient&&"horizontal"===e.orient()?e.yScale():e.xScale();e.bandwidth(i(a,t,e.crossValue))}};t instanceof o.selection?t.each((t,n,i)=>{a(t),e(o.select(i[n]))}):(a(t),e(t))};return X(r,e),r.widthFraction=(...e)=>e.length?(a=e[0],r):a,r},e.axisBottom=ya,e.axisLabelOffset=e=>{let t="auto",a=()=>{};const n=()=>"left"===e.orient()||"right"===e.orient(),r=()=>"top"===e.orient()||"left"===e.orient()?-1:1,l=a=>{const{maxHeight:l,maxWidth:d,labelCount:o}=Sa(e.scale())(a),s=e.scale().range()[1],c="auto"===t?O((n()?l:d)*o/s)+1:t,h=a.select("text"),g=h.attr("transform"),u=e=>n()?`translate(${e%c*d*r()}, 0)`:`translate(0, ${e%c*l*r()})`;h.attr("transform",(e,t)=>`${g} ${u(t)}`)},d=t=>e(t);return e.decorate(e=>{l(e),a(e)}),d.decorate=(...e)=>e.length?(a=e[0],d):a,d.labelOffsetDepth=(...e)=>e.length?(t=e[0],d):t,X(d,e,J("decorate")),d},e.axisLabelRotate=e=>{let t="auto",a=()=>{};const n=()=>"left"===e.orient()||"right"===e.orient(),i=()=>"top"===e.orient()||"left"===e.orient()?-1:1,r=()=>{switch(e.orient()){case"top":case"right":return"start";default:return"end";}},l=a=>{const{maxHeight:l,maxWidth:d,labelCount:o}=Sa(e.scale())(a),s=o*d;let c;if("auto"===t){const t=e.scale().range()[1];c=t<s?90*H(1,(s/t-.8)/2):0}else c=t;return{rotate:n()?O(i()*(90-c)):O(-c),maxHeight:l,maxWidth:d,anchor:c?r():"middle"}},d=e=>{const{rotate:t,maxHeight:a,anchor:r}=l(e),d=e.select("text"),o=d.attr("transform"),s=i()*O(a/2),c=n()?`translate(${s}, 0)`:`translate(0, ${s})`;d.style("text-anchor",r).attr("transform",`${o} ${c} rotate(${t} 0 0)`)},o=t=>{e(t)};return e.decorate(e=>{d(e),a(e)}),o.decorate=(...e)=>e.length?(a=e[0],o):a,o.labelRotate=(...e)=>e.length?(t=e[0],o):t,X(o,e,J("decorate")),o},e.axisLeft=xa,e.axisOrdinalBottom=e=>va("bottom",e),e.axisOrdinalLeft=e=>va("left",e),e.axisOrdinalRight=e=>va("right",e),e.axisOrdinalTop=e=>va("top",e),e.axisRight=ba,e.axisTop=ma,e.barFill=()=>{let e=[.86,.86,.86,1];const t=t=>{t.vertexShader().appendHeaderIfNotExists(Ye.header).appendBodyIfNotExists(Ye.body),t.fragmentShader().appendHeaderIfNotExists(mt.header).appendBodyIfNotExists(mt.body),t.buffers().uniform("uColor",Re(e))};return t.color=(...a)=>{if(!a.length)return e;const n=a[0],i="0x"+n[1]+n[2],r="0x"+n[3]+n[4],l="0x"+n[5]+n[6];return e=[+(i/255),+(r/255),+(l/255),1],t},t},e.baseAttributeBuilder=Ne,e.brush=()=>nn("xy"),e.brushX=()=>nn("x"),e.brushY=()=>nn("y"),e.bucket=C,e.bufferBuilder=Pe,e.chartCanvasCartesian=en,e.chartCartesian=Xa,e.chartSvgCartesian=$a,e.circlePointShader=St,e.dataJoin=he,e.discontinuityIdentity=V,e.discontinuityRange=(...e)=>{const t=(e,t)=>e>t[0]&&e<t[1],a=(e,t)=>e[0]>=t[0]&&e[1]<=t[1];var n={};n.distance=(t,i)=>{t=n.clampUp(t),i=n.clampDown(i);const r=e.filter(e=>a(e,[t,i])),l=r.map(e=>e[1]-e[0]);return i-t-l.reduce((e,t)=>e+t,0)};const i=(e,t)=>e instanceof Date?new Date(e.getTime()+t):e+t;return n.offset=(t,a)=>{if(0<a){let l=n.clampUp(t),d=a;for(;0<d;){const t=e.filter(e=>e[0]>l).sort((e,t)=>e[0]-t[0]);if(t.length){const e=t[0],a=e[0]-l;a>d?(l=i(l,d),d=0):(l=e[1],d-=a)}else l=i(l,d),d=0}return l}else{let l=n.clampDown(t),d=a;for(;0>d;){const t=e.filter(e=>e[1]<l).sort((e,t)=>t[0]-e[0]);if(t.length){const e=t[0],a=e[1]-l;a<d?(l=i(l,d),d=0):(l=e[0],d-=a)}else l=i(l,d),d=0}return l}},n.clampUp=a=>e.reduce((e,a)=>t(e,a)?a[1]:e,a),n.clampDown=a=>e.reduce((e,a)=>t(e,a)?a[0]:e,a),n.copy=()=>n,n},e.discontinuitySkipUtcWeekends=()=>ae(e=>e.getUTCDay(),n.utcDay,n.utcSaturday,n.utcMonday),e.discontinuitySkipWeekends=()=>ae(e=>e.getDay(),n.timeDay,n.timeSaturday,n.timeMonday),e.effectivelyZero=ce,e.exclude=J,e.extentDate=T,e.extentLinear=A,e.extentTime=T,e.feedGdax=P,e.fragmentShaderSnippets=vt,e.glArea=Mt,e.glBar=Ot,e.glBoxPlot=Qt,e.glCandlestick=Wt,e.glErrorBar=Gt,e.glLine=Rt,e.glOhlc=Lt,e.glPoint=Bt,e.glScaleLinear=Ue,e.glScaleLog=Me,e.glScalePow=Fe,e.group=()=>{let e="",t="vertical",a=(e,t)=>+e[t];const n=t=>Object.keys(t[0]).filter(t=>t!==e).map(n=>{const i=t.filter(e=>e[n]).map(t=>{const i=[t[e],a(t,n)];return i.data=t,i});return i.key=n,i}),i=t=>t.map(t=>{const n=Object.keys(t).filter(t=>t!==e).map(e=>{const n=[e,a(t,e)];return n.data=t,n});return n.key=t[e],n}),r=e=>"vertical"===t?n(e):i(e);return r.key=(...t)=>t.length?(e=t[0],r):e,r.value=(...e)=>e.length?(a=e[0],r):a,r.orient=(...e)=>e.length?(t=e[0],r):t,r},e.include=Z,e.includeMap=$,e.indicatorBollingerBands=y,e.indicatorElderRay=w,e.indicatorEnvelope=S,e.indicatorExponentialMovingAverage=x,e.indicatorForceIndex=function(){let e=e=>e.volume,t=e=>e.close;const a=x().period(13),n=m().period(2).defined(a=>null!=t(a)&&null!=e(a)).accumulator(a=>a&&p((t(a[1])-t(a[0]))*e(a[1]))),i=e=>{const t=n(e);return a(t)};return i.volumeValue=(...t)=>t.length?(e=t[0],i):e,i.closeValue=(...e)=>e.length?(t=e[0],i):t,q(i,a,"period"),i},e.indicatorMacd=b,e.indicatorMovingAverage=v,e.indicatorRelativeStrengthIndex=function(){const e=m().period(14),a=(e,t)=>t+(e[e.length-1]-t)/e.length,n=([e,t])=>e<t?0:e-t,i=([e,t])=>e>t?0:t-e,r=(e,n)=>void 0===n?t.mean(e):a(e,n),l=()=>{let e,a,l;return d=>{if(!d)return void(void 0!==e&&(e=NaN));if(void 0===e)return void(e=d[0]);const o=t.pairs([e,...d]);a=r(o.map(n),a),l=r(o.map(i),l);const s=isNaN(e)?NaN:l/a;return p(100-100/(1+s))}};var d=t=>{const a=l();return e.accumulator(a),e(t)};return q(d,e,"period","value"),d},e.indicatorStochasticOscillator=function(){let e=e=>e.close,a=e=>e.high,n=e=>e.low;const i=m().period(5).defined(t=>null!=e(t)&&null!=a(t)&&null!=n(t)).accumulator(i=>{const r=i&&t.max(i,a),l=i&&t.min(i,n),d=i&&100*(e(i[i.length-1])-l)/(r-l);return p(d)}),r=v().period(3),l=e=>{const t=i(e),a=r(t);return t.map((e,t)=>({k:e,d:a[t]}))};return l.closeValue=(...t)=>t.length?(e=t[0],l):e,l.highValue=(...e)=>e.length?(a=e[0],l):a,l.lowValue=(...e)=>e.length?(n=e[0],l):n,X(l,i,$({period:"kPeriod"})),X(l,r,$({period:"dPeriod"})),l},e.largestTriangleOneBucket=N,e.largestTriangleThreeBucket=R,e.layoutAnnealing=()=>{let e,t=1e3,a=1;const n=e=>{switch(e.location){case"bottom-right":return 0;case"middle-right":case"bottom-center":return e.width*e.height/8;}return e.width*e.height/4},i=t=>e?t.width*t.height-ue(t,e):0,r=(e,t,a)=>fe(a,t)+i(e)+n(e),l=e=>{let n=t;const i=(e,t)=>U((t-e)/n)>Math.random();let l=be().locationScore(r).winningScore(i).rectangles(e);for(;0<n;){const t=Se(e),i=ve(me(e[t]));l=l(i,t),n-=a}return l.rectangles()};return l.temperature=(...e)=>e.length?(t=e[0],l):t,l.cooling=(...e)=>e.length?(a=e[0],l):a,l.bounds=(...t)=>t.length?(e=t[0],l):e,l},e.layoutBoundingBox=()=>{let e=[0,0];const t=t=>t.map(t=>{let a=t.x,n=t.y;return a+t.width>e[0]&&(a-=t.width),n+t.height>e[1]&&(n-=t.height),{height:t.height,width:t.width,x:a,y:n}});return t.bounds=(...a)=>a.length?(e=a[0],t):e,t},e.layoutGreedy=()=>{let e;const t=t=>e?t.width*t.height-ue(t,e):0,a=(e,a,n)=>fe(n,a)+t(e),n=e=>{let t=be().locationScore(a).rectangles(e);return e.forEach((e,a)=>{me(e).forEach(e=>{t=t(e,a)})}),t.rectangles()};return n.bounds=(...t)=>t.length?(e=t[0],n):e,n},e.layoutLabel=e=>{let t=()=>{},n=()=>[0,0],r=e=>[e.x,e.y],l=e||(e=>e),d=()=>{},s=a.scaleIdentity(),c=a.scaleIdentity();const h=he("g","label"),g=e=>{e.each((e,a,i)=>{const u=h(o.select(i[a]),e).call(d),g=u.nodes(),f=g.map((e,t)=>{let a=o.select(e).datum();const i=r(a,t,g);let l=[s(i[0]),c(i[1])],d=n(a,t,g);return{hidden:!1,x:l[0],y:l[1],width:d[0],height:d[1]}}),p=l(f);u.attr("style",(e,t)=>"display:"+(p[t].hidden?"none":"inherit")).attr("transform",(e,t)=>"translate("+p[t].x+", "+p[t].y+")").attr("layout-width",(e,t)=>p[t].width).attr("layout-height",(e,t)=>p[t].height).attr("anchor-x",(e,t)=>f[t].x-p[t].x).attr("anchor-y",(e,t)=>f[t].y-p[t].y),u.call(d),t(u,e,a)})};return X(g,h,Z("key")),X(g,l),g.size=(...e)=>e.length?(n=se(e[0]),g):n,g.position=(...e)=>e.length?(r=se(e[0]),g):r,g.component=(...e)=>e.length?(d=e[0],g):d,g.decorate=(...e)=>e.length?(t=e[0],g):t,g.xScale=(...e)=>e.length?(s=e[0],g):s,g.yScale=(...e)=>e.length?(c=e[0],g):c,g},e.layoutRemoveOverlaps=e=>{e=e||(e=>e);const t=t=>{for(t=e(t);;){const e=t.filter(e=>!e.hidden),a=e.map((t,a)=>[t,fe(e,a)]),n=we(a,(e,t)=>t[1]-e[1]);if(0<n[1])n[0].hidden=!0;else break}return t};return X(t,e),t},e.layoutTextLabel=()=>{let e=2,t=e=>e;const a=he("text"),n=he("rect"),i=he("circle"),r=r=>{r.each((r,l,d)=>{const s=d[l],c=o.select(s);let h=+s.getAttribute("layout-width"),g=+s.getAttribute("layout-height"),u=n(c,[r]);u.attr("width",h).attr("height",g);let f=+s.getAttribute("anchor-x"),p=+s.getAttribute("anchor-y"),m=i(c,[r]);m.attr("r",2).attr("cx",f).attr("cy",p);let y=a(c,[r]);y.enter().attr("dy","0.9em").attr("transform",`translate(${e}, ${e})`),y.text(t)})};return r.padding=(...t)=>t.length?(e=t[0],r):e,r.value=(...e)=>e.length?(t=se(e[0]),r):t,r},e.lineWidth=At,e.modeMedian=D,e.pointAntiAlias=()=>{return e=>{e.fragmentShader().appendBodyIfNotExists(pt.body)}},e.pointFill=()=>{let e=[.86,.86,.86,1];const t=t=>{t.fragmentShader().appendHeaderIfNotExists(yt.header).appendBodyIfNotExists(yt.body),t.buffers().uniform("uColor",Re(e))};return t.color=(...a)=>a.length?(e=a[0],t):e,t},e.pointStroke=()=>{let e=[0,0,0,1],t=1;const a=a=>{a.fragmentShader().appendHeaderIfNotExists(xt.header).appendBodyIfNotExists(xt.body),a.buffers().uniform("uEdgeColor",Re(e)),a.buffers().uniform("uStrokeWidth",Re(t))};return a.color=(...t)=>t.length?(e=t[0],a):e,a.width=(...e)=>e.length?(t=e[0],a):t,a},e.pointer=()=>{function e(){const e=o.mouse(this);a.call("point",this,[{x:e[0],y:e[1]}])}function t(){void a.call("point",this,[])}const a=c.dispatch("point"),n=a=>{a.on("mouseenter.pointer",e).on("mousemove.pointer",e).on("mouseleave.pointer",t)};return q(n,a,"on"),n},e.prefix=te,e.programBuilder=He,e.randomFinancial=B,e.randomGeometricBrownianMotion=I,e.randomSkipWeekends=function(e){const t=e.date.getDay();return 0!==t&&6!==t},e.rebind=q,e.rebindAll=X,e.scaleDiscontinuous=E,e.scaleMapper=We,e.seriesCanvasArea=()=>{const e=Ae(),t=s.area(),a=a=>{const n=t.context();t.defined(e.defined());const r=a.map(e.values);t.x((e,t)=>r[t].transposedX).y((e,t)=>r[t].transposedY);const l="vertical"===e.orient()?"y":"x";t[l+"0"]((e,t)=>r[t].y0),t[l+"1"]((e,t)=>r[t].y),n.beginPath(),n.fillStyle=Te.gray,n.strokeStyle="transparent",e.decorate()(n,a),t(a),n.fill(),n.stroke(),n.closePath()};return X(a,e,J("bandwidth","align")),q(a,t,"curve","context"),a},e.seriesCanvasBar=()=>{const e=Ae(),t=re().x(0).y(0),a=t=>"vertical"===e.orient()?t.height:t.width,n=t=>"vertical"===e.orient()?t.width:t.height,i=i=>{const r=t.context(),l=i.filter(e.defined()),d=l.map(e.values);"vertical"===e.orient()?(t.verticalAlign("top"),t.horizontalAlign("center")):(t.horizontalAlign("right"),t.verticalAlign("center")),d.forEach((l,d)=>{r.save(),r.beginPath(),r.translate(l.origin[0],l.origin[1]),r.fillStyle=Te.darkGray,r.strokeStyle="transparent",e.decorate()(r,l.d,d),a(t)(-l.height),n(t)(l.width),t([l]),r.fill(),r.stroke(),r.closePath(),r.restore()})};return X(i,e),q(i,t,"context"),i},e.seriesCanvasBoxPlot=()=>{const e=ea(),t=de().value(0),a=a=>{const n=a.filter(e.defined()),r=t.context();t.orient(e.orient()),n.forEach((a,n)=>{r.save();const i=e.values(a,n);r.translate(i.origin[0],i.origin[1]),r.beginPath(),r.fillStyle=Te.gray,r.strokeStyle=Te.black,e.decorate()(r,a,n),t.median(i.median).upperQuartile(i.upperQuartile).lowerQuartile(i.lowerQuartile).high(i.high).width(i.width).low(i.low)([a]),r.fill(),r.stroke(),r.closePath(),r.restore()})};return X(a,e),q(a,t,"cap","context"),a},e.seriesCanvasCandlestick=()=>Zt(le()),e.seriesCanvasErrorBar=()=>{const e=Xt(),t=oe().value(0),a=a=>{const n=a.filter(e.defined()),r=t.context();t.orient(e.orient()),n.forEach((a,n)=>{r.save();const i=e.values(a,n);r.translate(i.origin[0],i.origin[1]),r.beginPath(),r.strokeStyle=Te.black,r.fillStyle=Te.gray,e.decorate()(r,a,n),t.high(i.high).width(i.width).low(i.low)([a]),r.fill(),r.stroke(),r.closePath(),r.restore()})};return X(a,e),q(a,t,"context"),a},e.seriesCanvasGrouped=function(e){const t=ia(),a=a=>{a.forEach((n,r)=>{const l="horizontal"!==e.orient(),d=(e,n)=>{const i=t.offsetScaleForDatum(a,e,n),d=l?t.xScale():t.yScale();return d(e)+i(r)+i.bandwidth()/2};l?(e.xScale(d),e.yScale(t.yScale())):(e.yScale(d),e.xScale(t.xScale())),e.bandwidth&&e.bandwidth((e,n)=>t.offsetScaleForDatum(a,e,n).bandwidth()),e.decorate((e,a)=>t.decorate()(e,a,r)),e(n)})};return X(a,e,J("decorate","xScale","yScale")),X(a,t,J("offsetScaleForDatum")),a},e.seriesCanvasHeatmap=()=>{const e=da(),t=t=>{const a=t.filter(e.defined()),n=e.colorInterpolate(),r=e.colorScale(a),l=e.pathGenerator.context();a.forEach((t,a)=>{l.save(),l.beginPath();const i=e.values(t,a);l.translate(i.x,i.y),l.fillStyle=n(r(i.colorValue)),l.strokeStyle="transparent",e.decorate()(l,t,a),e.pathGenerator.height(i.height).width(i.width)([t]),l.fill(),l.stroke(),l.closePath(),l.restore()})};return q(t,e.pathGenerator,"context"),X(t,e),t},e.seriesCanvasLine=_e,e.seriesCanvasMulti=na,e.seriesCanvasOhlc=()=>Zt(ie()),e.seriesCanvasPoint=jt,e.seriesCanvasRepeat=ra,e.seriesSvgArea=()=>{const e=Ae(),t=s.area(),a=he("path","area"),n=n=>{n.selection&&a.transition(n),t.defined(e.defined()),n.each((n,i,r)=>{const l=n.map(e.values);t.x((e,t)=>l[t].transposedX).y((e,t)=>l[t].transposedY);const d="vertical"===e.orient()?"y":"x";t[d+"0"]((e,t)=>l[t].y0),t[d+"1"]((e,t)=>l[t].y);const s=a(o.select(r[i]),[n]);s.enter().attr("fill",Te.gray),s.attr("d",t),e.decorate()(s,n,i)})};return X(n,e,J("bandwidth","align")),q(n,a,"key"),q(n,t,"curve"),n},e.seriesSvgBar=()=>{const e=re().x(0).y(0),t=Ae(),a=he("g","bar"),n=e=>"vertical"===t.orient()?e.height:e.width,r=e=>"vertical"===t.orient()?e.width:e.height,l=e=>"translate("+e[0]+", "+e[1]+")",d=i=>{i.selection&&a.transition(i),i.each((i,d,s)=>{const c=t.orient();if("vertical"!==c&&"horizontal"!==c)throw new Error("The bar series does not support an orientation of "+c);const h=i.filter(t.defined()),u=h.map(t.values);e.width(0).height(0),"vertical"===t.orient()?(e.verticalAlign("top"),e.horizontalAlign("center")):(e.horizontalAlign("right"),e.verticalAlign("center"));const f=a(o.select(s[d]),h);f.enter().attr("transform",(e,t)=>l(u[t].baseOrigin)).attr("class","bar "+t.orient()).attr("fill",Te.darkGray).append("path").attr("d",(t,a)=>(r(e)(u[a].width),e([t]))),f.attr("transform",(e,t)=>l(u[t].origin)).select("path").attr("d",(t,a)=>(r(e)(u[a].width),n(e)(-u[a].height),e([t]))),t.decorate()(f,h,d)})};return X(d,t),q(d,a,"key"),d},e.seriesSvgBoxPlot=()=>{const e=ea(),t=he("g","box-plot"),a=de().value(0),n=e=>t=>e.selection?t.transition(e):t,r=e=>"translate("+e.origin[0]+", "+e.origin[1]+")",l=i=>{i.selection&&t.transition(i);const l=n(i);i.each((n,i,d)=>{const s=n.filter(e.defined()),c=t(o.select(d[i]),s);c.enter().attr("stroke",Te.black).attr("fill",Te.gray).attr("transform",(t,a)=>r(e.values(t,a))+" scale(1e-6, 1)").append("path"),a.orient(e.orient()),c.each((t,n,i)=>{const d=e.values(t,n);a.median(d.median).upperQuartile(d.upperQuartile).lowerQuartile(d.lowerQuartile).width(d.width).high(d.high).low(d.low),l(o.select(i[n])).attr("transform",r(d)).select("path").attr("d",a([t]))}),e.decorate()(c,n,i)})};return X(l,e),q(l,t,"key"),q(l,a,"cap"),l},e.seriesSvgCandlestick=()=>Jt(le(),"candlestick"),e.seriesSvgErrorBar=()=>{const e=Xt(),t=he("g","error-bar"),a=oe().value(0),n=e=>t=>e.selection?t.transition(e):t,r=e=>"translate("+e.origin[0]+", "+e.origin[1]+")",l=i=>{i.selection&&t.transition(i);const l=n(i);i.each((n,i,d)=>{const s=n.filter(e.defined()),c=s.map(e.values),h=t(o.select(d[i]),s);h.enter().attr("stroke",Te.black).attr("fill",Te.gray).attr("transform",(t,a)=>r(e.values(t,a))+" scale(1e-6, 1)").append("path"),a.orient(e.orient()),h.each((e,t,n)=>{const i=c[t];a.high(i.high).low(i.low).width(i.width),l(o.select(n[t])).attr("transform",r(i)+" scale(1)").select("path").attr("d",a([e]))}),e.decorate()(h,n,i)})};return X(l,e),q(l,t,"key"),l},e.seriesSvgGrouped=e=>{const t=ia(),a=he("g","grouped"),n=n=>{n.selection&&a.transition(n),n.each((n,i,r)=>{const l=a(o.select(r[i]),n);l.enter().append("g"),l.select("g").each((a,r,l)=>{const d=o.select(l[r]),s="horizontal"!==e.orient(),c=(e,a)=>{const i=t.offsetScaleForDatum(n,e,a),l=s?t.xScale():t.yScale();return l(e)+i(r)+i.bandwidth()/2};s?(e.xScale(c),e.yScale(t.yScale())):(e.yScale(c),e.xScale(t.xScale())),e.bandwidth&&e.bandwidth((e,a)=>t.offsetScaleForDatum(n,e,a).bandwidth()),e.decorate((e,a)=>t.decorate()(e,a,r)),d.call(e)})})};return X(n,e,J("decorate","xScale","yScale")),X(n,t,J("offsetScaleForDatum")),n},e.seriesSvgHeatmap=()=>{const e=da(),t=he("g","box"),a=e=>"translate("+e.x+", "+e.y+")",n=n=>{n.each((n,i,r)=>{const l=n.filter(e.defined()),s=e.colorValue(),c=e.colorInterpolate(),h=e.colorScale(l),u=t(o.select(r[i]),l);u.enter().append("path").attr("stroke","transparent"),u.attr("transform",(t,n)=>a(e.values(t,n))).select("path").attr("d",(t,a)=>e.pathGenerator.width(e.values(t,a).width).height(e.values(t,a).height)([t])).attr("fill",(e,t)=>c(h(s(e,t)))),e.decorate()(u,n,i)})};return X(n,e),n},e.seriesSvgLine=Ie,e.seriesSvgMulti=aa,e.seriesSvgOhlc=()=>Jt(ie(),"ohlc"),e.seriesSvgPoint=qt,e.seriesSvgRepeat=()=>{let e="vertical",t=Ie();const a=aa(),n=n=>n.each((n,i,r)=>{"vertical"===e?a.series(n[0].map(()=>t)).mapping((e,t)=>e.map(e=>e[t])):a.series(n.map(()=>t)).mapping((e,t)=>e[t]),o.select(r[i]).call(a)});return n.series=(...e)=>e.length?(t=e[0],n):t,n.orient=(...t)=>t.length?(e=t[0],n):e,X(n,a,J("series","mapping")),n},e.seriesWebglArea=()=>{const e=Ae(),t=Mt();let a=()=>!1,n=[];const i=i=>{const r=We(e.xScale()),l=We(e.yScale());if(!Be(r.scale)||!Be(l.scale)||!a(n,i)){n=i;const a=new Float32Array(i.length),o=new Float32Array(i.length),s=new Float32Array(i.length),c=new Float32Array(i.length);i.forEach((t,n)=>{a[n]=r.scale(e.crossValue()(t,n)),o[n]=l.scale(e.mainValue()(t,n)),s[n]=l.scale(e.baseValue()(t,n)),c[n]=e.defined()(t,n)}),t.xValues(a).yValues(o).y0Values(s).defined(c)}t.xScale(r.glScale).yScale(l.glScale).decorate(t=>e.decorate()(t,i,0)),t(i.length)};return i.equals=(...e)=>e.length?(a=e[0],i):a,X(i,e,J("bandwidth","align")),q(i,t,"context"),i},e.seriesWebglBar=()=>{const e=Ae(),t=Ot();let a=()=>!1,n=[];const i=i=>{const r=We(e.xScale()),l=We(e.yScale());if(!Be(r.scale)||!Be(l.scale)||!a(n,i)){n=i;const a=new Float32Array(i.length),o=new Float32Array(i.length),s=new Float32Array(i.length),c=new Float32Array(i.length),h=new Float32Array(i.length);i.forEach((t,n)=>{a[n]=r.scale(e.crossValue()(t,n)),c[n]=r.scale(e.bandwidth()(t,n)),o[n]=l.scale(e.baseValue()(t,n)),s[n]=l.scale(e.mainValue()(t,n)),h[n]=e.defined()(t,n)}),t.xValues(a).y0Values(o).yValues(s).widths(c).defined(h)}t.xScale(r.glScale).yScale(l.glScale).decorate(t=>e.decorate()(t,i,0)),t(i.length)};return i.equals=(...e)=>e.length?(a=e[0],i):a,X(i,e,J("align")),q(i,t,"context"),i},e.seriesWebglBoxPlot=()=>{const e=ea();let t=Ve(.5);const a=Qt();let n=()=>!1,i=[];const r=r=>{const l=We(e.xScale()),o=We(e.yScale());if(!Be(l.scale)||!Be(o.scale)||!n(i,r)){i=r;const n=new Float32Array(r.length),s=new Float32Array(r.length),c=new Float32Array(r.length),h=new Float32Array(r.length),g=new Float32Array(r.length),u=new Float32Array(r.length),f=new Float32Array(r.length),p=new Float32Array(r.length),m=new Float32Array(r.length);r.forEach((a,r)=>{n[r]=l.scale(e.crossValue()(a,r)),s[r]=o.scale(e.medianValue()(a,r)),c[r]=o.scale(e.upperQuartileValue()(a,r)),h[r]=l.scale(e.lowerQuartileValue()(a,r)),g[r]=o.scale(e.highValue()(a,r)),u[r]=o.scale(e.lowValue()(a,r)),f[r]=e.bandwidth()(a,r),p[r]=f[r]*t(a,r),m[r]=e.defined()(a,r)}),a.xValues(n).medianValues(s).upperQuartileValues(c).lowerQuartileValues(h).highValues(g).lowValues(u).bandwidth(f).capWidth(p).defined(m)}a.xScale(l.glScale).yScale(o.glScale).decorate(t=>e.decorate()(t,r,0)),a(r.length)};return r.cap=(...e)=>e.length?(t=Ve(e[0]),r):t,r.equals=(...e)=>e.length?(n=e[0],r):n,X(r,e,J("align")),q(r,a,"context","lineWidth"),r},e.seriesWebglCandlestick=()=>$t(Wt()),e.seriesWebglErrorBar=()=>{const e=Xt(),t=Gt();let a=()=>!1,n=[];const i=i=>{const r=We(e.xScale()),l=We(e.yScale());if(!Be(r.scale)||!Be(l.scale)||!a(n,i)){n=i;const a=new Float32Array(i.length),o=new Float32Array(i.length),s=new Float32Array(i.length),c=new Float32Array(i.length),h=new Float32Array(i.length);i.forEach((t,n)=>{a[n]=r.scale(e.crossValue()(t,n)),o[n]=l.scale(e.highValue()(t,n)),s[n]=l.scale(e.lowValue()(t,n)),c[n]=e.bandwidth()(t,n),h[n]=e.defined()(t,n)}),t.xValues(a).highValues(o).lowValues(s).bandwidth(c).defined(h)}t.xScale(r.glScale).yScale(l.glScale).decorate(t=>e.decorate()(t,i,0)),t(i.length)};return i.equals=(...e)=>e.length?(a=e[0],i):a,X(i,e,J("align")),q(i,t,"context","lineWidth"),i},e.seriesWebglLine=()=>{function e(){return"vertical"===t.orient()?{x:t.crossValue(),y:t.mainValue(),defined:t.defined()}:{x:t.mainValue(),y:t.crossValue(),defined:t.defined()}}const t=Ae(),a=Rt();let n=()=>!1,i=[];const r=r=>{const l=We(t.xScale()),o=We(t.yScale());if(!Be(l.scale)||!Be(o.scale)||!n(i,r)){i=r;const t=e(),n=new Float32Array(r.length),s=new Float32Array(r.length),c=new Float32Array(r.length);r.forEach((e,a)=>{n[a]=l.scale(t.x(e,a)),s[a]=o.scale(t.y(e,a)),c[a]=t.defined(e,a)}),a.xValues(n).yValues(s).defined(c)}a.xScale(l.glScale).yScale(o.glScale).decorate(e=>{t.decorate()(e,r,0)}),a(r.length)};return r.equals=(...e)=>e.length?(n=e[0],r):n,X(r,t,J("baseValue","bandwidth","align")),q(r,a,"context","lineWidth"),r},e.seriesWebglMulti=na,e.seriesWebglOhlc=()=>$t(Lt()),e.seriesWebglPoint=()=>{function e(){return"vertical"===t.orient()?{x:t.crossValue(),y:t.mainValue()}:{x:t.mainValue(),y:t.crossValue()}}const t=Ae();let a=64,n=Y.symbolCircle;const i=Bt();let r=()=>!1,l=[];const d=d=>{const o=We(t.xScale()),s=We(t.yScale());if(!Be(o.scale)||!Be(s.scale)||!r(l,d)){l=d;const n=e(),r=new Float32Array(d.length),c=new Float32Array(d.length),h=new Float32Array(d.length),g=new Float32Array(d.length);d.forEach((e,l)=>{const i="function"==typeof a?a:()=>a;r[l]=o.scale(n.x(e,l)),c[l]=s.scale(n.y(e,l)),h[l]=i(e),g[l]=t.defined()(e,l)}),i.xValues(r).yValues(c).sizes(h).defined(g)}i.xScale(o.glScale).yScale(s.glScale).type(Et(n)).decorate(e=>t.decorate()(e,d,0)),i(d.length)};return d.size=(...e)=>e.length?(a=e[0],d):a,d.type=(...e)=>e.length?(n=e[0],d):n,d.equals=(...e)=>e.length?(r=e[0],d):r,X(d,t,J("baseValue","bandwidth","align")),q(d,i,"context"),d},e.seriesWebglRepeat=ra,e.shaderBuilder=De,e.shapeBar=re,e.shapeBoxPlot=de,e.shapeCandlestick=le,e.shapeErrorBar=oe,e.shapeOhlc=ie,e.squarePointShader=wt,e.symbolMapper=Et,e.uniformBuilder=Re,e.vertexShaderSnippets=it,Object.defineProperty(e,"__esModule",{value:!0})});
